<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE html><html xmlns="http://www.w3.org/1999/xhtml"><head><title>query</title><link rel="stylesheet" type="text/css" href="../../docbook.css"/><meta name="generator" content="DocBook XSL Stylesheets Vsnapshot"/><meta name="keywords" content="Spring, Spring Boot, Spring Cloud, Spring Eureka, Spring Config"/><link rel="prev" href="ch51s06.xhtml" title="queryForMap"/><link rel="next" href="ch51s08.xhtml" title="queryForRowSet"/></head><body><header><div class="navheader"><table style="width: 100%; "><tr><th style="text-align: center; " colspan="3">query</th></tr><tr><td style="width: 20%; text-align: left; "><a accesskey="p" href="ch51s06.xhtml">上一页</a> </td><th style="width: 60%; text-align: center; ">第 51 章 Spring Data with JdbcTemplate</th><td style="width: 20%; text-align: right; "> <a accesskey="n" href="ch51s08.xhtml">下一页</a></td></tr></table><hr/></div></header><section class="section" id="query"><div class="titlepage"><div><div><h2 class="title" style="clear: both">query</h2></div></div></div><section class="section" id="id1104"><div class="titlepage"><div><div><h3 class="title">ResultSet</h3></div></div></div><pre class="programlisting">
			
HashMap&lt;String,String&gt; member = jdbcTemplate.query("select name,age from member where id=1", (ResultSet rs) -&gt; {
    HashMap&lt;String,String&gt; results = new HashMap&lt;&gt;();
    while (rs.next()) {
        results.put(rs.getString("name"), rs.getString("age"));
    }
    return results;
}); 
			
			</pre></section><section class="section" id="id1105"><div class="titlepage"><div><div><h3 class="title">ResultSetExtractor</h3></div></div></div><p>ResultSetExtractor</p><pre class="programlisting">
			
HashMap&lt;String,String&gt; member = jdbcTemplate.query("select name,age from member where id=1", new ResultSetExtractor&lt;Map&gt;(){
    @Override
    public Map extractData(ResultSet rs) throws SQLException,DataAccessException {
        HashMap&lt;String,String&gt; mapResult= new HashMap&lt;String,String&gt;();
        while(rs.next()){
            mapResult.put(rs.getString("name"),rs.getString("age"));
        }
        return mapResult;
    }
});
			
			</pre></section><section class="section" id="id1106"><div class="titlepage"><div><div><h3 class="title">RowMapper</h3></div></div></div><pre class="programlisting">
			
List&lt;Actor&gt; actors = this.jdbcTemplate.query("select first_name, last_name from actor",new RowMapper&lt;Actor&gt;() {
    public Actor mapRow(ResultSet rs, int rowNum) throws SQLException {
        Actor actor = new Actor();
        actor.setFirstName(rs.getString("first_name"));
        actor.setLastName(rs.getString("last_name"));
        return actor;
    }
});
			
			</pre><pre class="programlisting">
			
public List&lt;Actor&gt; findAllActors() {
    return this.jdbcTemplate.query( "select first_name, last_name from actor", new ActorMapper());
}

private static final class ActorMapper implements RowMapper&lt;Actor&gt; {

    public Actor mapRow(ResultSet rs, int rowNum) throws SQLException {
        Actor actor = new Actor();
        actor.setFirstName(rs.getString("first_name"));
        actor.setLastName(rs.getString("last_name"));
        return actor;
    }
}
			
			</pre><p>返回第一条数据，事实上只有一条。</p><pre class="programlisting">
			
	public Token getTokenBySymbol(String symbol) {

		List&lt;Token&gt; response = jdbcTemplate.query("select * from token where symbol ='" + symbol + "'", new RowMapper&lt;Token&gt;() {
			public Token mapRow(ResultSet result, int rowNum) throws SQLException {
				Token Token = new Token();
				Token.setContractAddress(result.getString(""));
				Token.setName(result.getString("name"));
				Token.setSymbol(result.getString("symbol"));
				Token.setDecimals(result.getInt("decimals"));
				return Token;
			}
		});

		if (response.size() == 1) {
			return response.get(0);
		}
		return null;
	}			
			
			</pre></section></section><footer><div class="navfooter"><hr/><table style="width: 100%; "><tr><td style="width: 40%; text-align: left; "><a accesskey="p" href="ch51s06.xhtml">上一页</a> </td><td style="width: 20%; text-align: center; "><a accesskey="u" href="ch51.xhtml">上一级</a></td><td style="width: 40%; text-align: right; "> <a accesskey="n" href="ch51s08.xhtml">下一页</a></td></tr><tr><td style="width: 40%; text-align: left; vertical-align: top; ">queryForMap </td><td style="width: 20%; text-align: center; "><a accesskey="h" href="../../index.xhtml">起始页</a></td><td style="width: 40%; text-align: right; vertical-align: top; "> queryForRowSet</td></tr></table></div></footer></body></html>