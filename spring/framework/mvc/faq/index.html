<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8" /><title>第 44 章 FAQ</title><link rel="stylesheet" type="text/css" href="../../../docbook.css" /><meta name="generator" content="DocBook XSL Stylesheets Vsnapshot" /><meta name="keywords" content="Spring, Spring Boot, Spring Cloud, Spring Eureka, Spring Config" /><link rel="home" href="../../../index.html" title="Netkiller Spring Cloud 手札" /><link rel="up" href="../index.html" title="第 43 章 Spring MVC" /><link rel="prev" href="../interceptor.html" title="43.8. Interceptor/Filter 拦截器/过滤" /><link rel="next" href="../../webflux/webflux.html" title="第 45 章 WebFlux framework" /></head><body><a xmlns="" href="//www.netkiller.cn/">Home</a> | <a xmlns="" href="//netkiller.github.io/">简体中文</a> | <a xmlns="" href="http://netkiller.sourceforge.net/">繁体中文</a> | <a xmlns="" href="/journal/index.html">杂文</a>
		| <a xmlns="" href="https://github.com/netkiller">Github</a> | <a xmlns="" href="https://zhuanlan.zhihu.com/netkiller">知乎专栏</a> | <a xmlns="" href="https://edu.51cto.com/lecturer/1703915.html">51CTO学院</a> | <a xmlns="" href="https://edu.csdn.net/lecturer/6423">CSDN程序员研修院</a> | <a xmlns="" href="http://my.oschina.net/neochen/">OSChina 博客</a> | <a xmlns="" href="https://cloud.tencent.com/developer/column/2078">腾讯云社区</a> | <a xmlns="" href="https://yq.aliyun.com/u/netkiller/">阿里云栖社区</a> | <a xmlns="" href="https://www.facebook.com/bg7nyt">Facebook</a> | <a xmlns="" href="http://cn.linkedin.com/in/netkiller/">Linkedin</a> | <a xmlns="" href="https://www.youtube.com/user/bg7nyt/videos">Youtube</a> | <a xmlns="" href="//www.netkiller.cn/home/donations.html">打赏(Donations)</a> | <a xmlns="" href="//www.netkiller.cn/home/about.html">About</a><div class="navheader"><table width="100%" summary="Navigation header"><tr><th colspan="3" align="center">第 44 章 FAQ</th></tr><tr><td width="20%" align="left"><a accesskey="p" href="../interceptor.html">上一页</a> </td><th width="60%" align="center">第 43 章 Spring MVC</th><td width="20%" align="right"> <a accesskey="n" href="../../webflux/webflux.html">下一页</a></td></tr></table><hr /></div><table xmlns=""><tr><td><iframe src="//ghbtns.com/github-btn.html?user=netkiller&amp;repo=netkiller.github.io&amp;type=watch&amp;count=true&amp;size=large" height="30" width="170" frameborder="0" scrolling="0" style="width:170px; height: 30px;" allowTransparency="true"></iframe></td><td><iframe src="//ghbtns.com/github-btn.html?user=netkiller&amp;repo=netkiller.github.io&amp;type=fork&amp;count=true&amp;size=large" height="30" width="170" frameborder="0" scrolling="0" style="width:170px; height: 30px;" allowTransparency="true"></iframe></td><td><iframe src="//ghbtns.com/github-btn.html?user=netkiller&amp;type=follow&amp;count=true&amp;size=large" height="30" width="240" frameborder="0" scrolling="0" style="width:240px; height: 30px;" allowTransparency="true"></iframe></td><td></td><td><a href="https://zhuanlan.zhihu.com/netkiller"><img src="/images/logo/zhihu-card-default.svg" height="25" /></a></td><td valign="middle"><a href="https://zhuanlan.zhihu.com/netkiller">知乎专栏</a></td><td></td><td></td><td></td><td></td></tr></table><div class="chapter"><div class="titlepage"><div><div><h2 class="title"><a id="index"></a>第 44 章 FAQ</h2></div></div></div><div class="toc"><p><strong>目录</strong></p><dl class="toc"><dt><span class="section"><a href="index.html#faq">44.1. FAQ</a></span></dt><dd><dl><dt><span class="section"><a href="index.html#idm358989071616">44.1.1. o.s.web.servlet.PageNotFound</a></span></dt><dt><span class="section"><a href="index.html#idm358989069248">44.1.2. HTTP Status 500 - Handler processing failed; nested exception
				is java.lang.NoClassDefFoundError:
				javax/servlet/jsp/jstl/core/Config
			</a></span></dt><dt><span class="section"><a href="index.html#idm358989067296">44.1.3. 同时使用 Thymeleaf 与 JSP </a></span></dt><dt><span class="section"><a href="index.html#idm358989063440">44.1.4. 排除静态内容</a></span></dt><dt><span class="section"><a href="index.html#idm358989059920">44.1.5. HTTP Status 406</a></span></dt><dt><span class="section"><a href="index.html#idm358989057552">44.1.6. Caused by: java.lang.IllegalArgumentException: Not a managed type: class common.domain.Article</a></span></dt><dt><span class="section"><a href="index.html#error.unauthorized">44.1.7. {"error":"unauthorized","error_description":"Full authentication is required to access this resource"}</a></span></dt><dt><span class="section"><a href="index.html#idm358989048512">44.1.8. @Value 取不到值</a></span></dt><dt><span class="section"><a href="index.html#faq.springboot.2.1.0">44.1.9. Spring boot 2.1.0</a></span></dt><dt><span class="section"><a href="index.html#idm358989044064">44.1.10. Field authenticationManager in cn.netkiller.oauth2.config.AuthorizationServerConfigurer required a bean of type 'org.springframework.security.authentication.AuthenticationManager' that could not be found.</a></span></dt><dt><span class="section"><a href="index.html#idm358989041168">44.1.11. 打印 Bean 信息</a></span></dt><dt><span class="section"><a href="index.html#idm358989039904">44.1.12. The dependencies of some of the beans in the application context form a cycle</a></span></dt><dt><span class="section"><a href="index.html#Could not read document: Invalid UTF-8 middle byte 0xd0">44.1.13. Could not read document: Invalid UTF-8 middle byte 0xd0</a></span></dt><dt><span class="section"><a href="index.html#idm358989031184">44.1.14. Field javaMailSender in cn.netkiller.rest.EmailRestController
				required a bean of type
				'org.springframework.mail.javamail.JavaMailSender' that could not be
				found.
			</a></span></dt><dt><span class="section"><a href="index.html#idm358989027632">44.1.15. no main manifest attribute, in /srv/job-admin.jar</a></span></dt></dl></dd></dl></div>
	
<div class="section"><div class="titlepage"><div><div><h3 class="title"><a id="faq"></a>44.1. FAQ</h3></div></div></div>
		
		<div class="section"><div class="titlepage"><div><div><h4 class="title"><a id="idm358989071616"></a>44.1.1. o.s.web.servlet.PageNotFound</h4></div></div></div>
			
			<p>解决方法，加入下面代码到 dispatcher-servlet.xml 文件中</p>
			<pre class="screen">
			
&lt;mvc:annotation-driven /&gt;			
			
			</pre>
			<p>dispatcher-servlet.xml</p>
			<pre class="screen">
			
&lt;?xml version="1.0" encoding="UTF-8"?&gt;
&lt;beans xmlns="http://www.springframework.org/schema/beans"
	xmlns:mvc="http://www.springframework.org/schema/mvc" xmlns:context="http://www.springframework.org/schema/context"
	xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
	xsi:schemaLocation="
        http://www.springframework.org/schema/beans     
        http://www.springframework.org/schema/beans/spring-beans.xsd
        http://www.springframework.org/schema/mvc 
        http://www.springframework.org/schema/mvc/spring-mvc.xsd
        http://www.springframework.org/schema/context 
        http://www.springframework.org/schema/context/spring-context.xsd"&gt;

	&lt;context:component-scan base-package="cn.netkiller.controller" /&gt;
	&lt;mvc:annotation-driven /&gt;
	&lt;bean id="viewResolver"
		class="org.springframework.web.servlet.view.UrlBasedViewResolver"&gt;
		&lt;property name="viewClass"
			value="org.springframework.web.servlet.view.JstlView" /&gt;
		&lt;property name="prefix" value="/WEB-INF/jsp/" /&gt;
		&lt;property name="suffix" value=".jsp" /&gt;
	&lt;/bean&gt;

&lt;/beans&gt;
			
			</pre>
		</div>
		<div class="section"><div class="titlepage"><div><div><h4 class="title"><a id="idm358989069248"></a>44.1.2. HTTP Status 500 - Handler processing failed; nested exception
				is java.lang.NoClassDefFoundError:
				javax/servlet/jsp/jstl/core/Config
			</h4></div></div></div>
			
			<p>pom.xml 文件中加入依赖包</p>
			<pre class="screen">
			
		&lt;dependency&gt;
			&lt;groupId&gt;javax.servlet&lt;/groupId&gt;
			&lt;artifactId&gt;jstl&lt;/artifactId&gt;
			&lt;version&gt;1.2&lt;/version&gt;
		&lt;/dependency&gt;
			
			</pre>
		</div>
		<div class="section"><div class="titlepage"><div><div><h4 class="title"><a id="idm358989067296"></a>44.1.3. 同时使用 Thymeleaf 与 JSP </h4></div><div><h5 class="subtitle">Using both Thymeleaf and JSP</h5></div></div></div>
			
			
			<pre class="programlisting">
			
	&lt;bean
		class="org.springframework.web.servlet.view.InternalResourceViewResolver"&gt;
		&lt;property name="viewClass"
			value="org.springframework.web.servlet.view.JstlView" /&gt;
		&lt;property name="prefix" value="/WEB-INF/jsp/" /&gt;
		&lt;!-- &lt;property name="suffix" value=".jsp" /&gt; --&gt;
		&lt;property name="viewNames" value="*.jsp" /&gt;
	&lt;/bean&gt;

	&lt;bean id="templateResolver"
		class="org.thymeleaf.templateresolver.ServletContextTemplateResolver"&gt;
		&lt;property name="prefix" value="/WEB-INF/templates/" /&gt;
		&lt;!-- &lt;property name="suffix" value=".html" /&gt; --&gt;
		&lt;property name="templateMode" value="HTML5" /&gt;
	&lt;/bean&gt;

	&lt;bean id="templateEngine" class="org.thymeleaf.spring4.SpringTemplateEngine"&gt;
		&lt;property name="templateResolver" ref="templateResolver" /&gt;
	&lt;/bean&gt;

	&lt;bean class="org.thymeleaf.spring4.view.ThymeleafViewResolver"&gt;
		&lt;property name="templateEngine" ref="templateEngine" /&gt;
		&lt;property name="viewNames" value="*.html" /&gt;
	&lt;/bean&gt;	
			
			</pre>
			<pre class="programlisting">
			
@RequestMapping("/thymeleaf")
public String thymeleafView(){
    return "thymeleaf.html";
}

@RequestMapping("/jsp")
public String jspView(){
    return "jstl.jsp";
}
			
			</pre>
			<pre class="programlisting">
			
			&lt;property name="viewNames" value="*thymeleaf/*" /&gt;
			
@RequestMapping(value="/test")
public ModelAndView dboxPrint(Model model){
    ModelAndView modelAndView = new ModelAndView("thymeleaf/test");
    return modelAndView;
}
			
			</pre>
		</div>
		<div class="section"><div class="titlepage"><div><div><h4 class="title"><a id="idm358989063440"></a>44.1.4. 排除静态内容</h4></div></div></div>
			
			<p>方法一，排除静态内容如 images, css, js 等等</p>
			<pre class="programlisting">
			
	&lt;servlet&gt;
        &lt;servlet-name&gt;springframework&lt;/servlet-name&gt;
        &lt;servlet-class&gt;
            org.springframework.web.servlet.DispatcherServlet
        &lt;/servlet-class&gt;
        &lt;load-on-startup&gt;1&lt;/load-on-startup&gt;
    &lt;/servlet&gt;
	&lt;servlet-mapping&gt;
	    &lt;servlet-name&gt;default&lt;/servlet-name&gt;
	    &lt;url-pattern&gt;/images/*&lt;/url-pattern&gt;
	    &lt;url-pattern&gt;*.css&lt;/url-pattern&gt;
	    &lt;url-pattern&gt;/js/*.js&lt;/url-pattern&gt;
	&lt;/servlet-mapping&gt;    
    &lt;servlet-mapping&gt;
        &lt;servlet-name&gt;springframework&lt;/servlet-name&gt;
        &lt;url-pattern&gt;/welcome.jsp&lt;/url-pattern&gt;
        &lt;url-pattern&gt;/welcome.html&lt;/url-pattern&gt;
        &lt;url-pattern&gt;*.html&lt;/url-pattern&gt;
    &lt;/servlet-mapping&gt;			
			
			</pre>
			<p>方法二</p>
			<pre class="programlisting">
			
	&lt;mvc:resources location="/images/" mapping="/images/**" /&gt;
	&lt;mvc:resources location="/css/" mapping="/css/**" /&gt;
	&lt;mvc:resources location="/js/" mapping="/js/**" /&gt;			
			
			</pre>
		</div>
		<div class="section"><div class="titlepage"><div><div><h4 class="title"><a id="idm358989059920"></a>44.1.5. HTTP Status 406</h4></div></div></div>
			
			<p>配置 url-pattern 增加需要传递给Spring的扩展名</p>
			<pre class="screen">
			
	&lt;servlet&gt;
        &lt;servlet-name&gt;springframework&lt;/servlet-name&gt;
        &lt;servlet-class&gt;
            org.springframework.web.servlet.DispatcherServlet
        &lt;/servlet-class&gt;
        &lt;load-on-startup&gt;1&lt;/load-on-startup&gt;
    &lt;/servlet&gt;
   
    &lt;servlet-mapping&gt;
        &lt;servlet-name&gt;springframework&lt;/servlet-name&gt;
        &lt;url-pattern&gt;/welcome.jsp&lt;/url-pattern&gt;
        &lt;url-pattern&gt;/welcome.html&lt;/url-pattern&gt;
        &lt;url-pattern&gt;*.json&lt;/url-pattern&gt;
        &lt;url-pattern&gt;*.xml&lt;/url-pattern&gt;
        &lt;url-pattern&gt;*.html&lt;/url-pattern&gt;
    &lt;/servlet-mapping&gt;		
			
			</pre>
		</div>
		<div class="section"><div class="titlepage"><div><div><h4 class="title"><a id="idm358989057552"></a>44.1.6. Caused by: java.lang.IllegalArgumentException: Not a managed type: class common.domain.Article</h4></div></div></div>
			
			<p>背景描述：Springboot 入口文件 Application.java 的包是 package api; 为了让 domain,pojo 共用，于是将 domain 放到Maven module下命令为 common。启动后出现这个故障。</p>
			<p>解决方案增加 @EntityScan("common.domain") 即可。</p>
			<pre class="programlisting">
			
package api;

import org.springframework.boot.SpringApplication;
import org.springframework.boot.autoconfigure.SpringBootApplication;
import org.springframework.boot.autoconfigure.domain.EntityScan;
import org.springframework.cloud.netflix.eureka.EnableEurekaClient;
import org.springframework.scheduling.annotation.EnableScheduling;

@SpringBootApplication
@EnableScheduling
@EnableEurekaClient
@EntityScan("common.domain")
public class Application {

	public static void main(String[] args) {
		System.out.println( "Service Api Starting..." );
		SpringApplication.run(Application.class, args);
	}
}
			
			
			</pre>
		</div>
		<div class="section"><div class="titlepage"><div><div><h4 class="title"><a id="error.unauthorized"></a>44.1.7. {"error":"unauthorized","error_description":"Full authentication is required to access this resource"}</h4></div></div></div>
			
			<p>Oauth @RestController 一切正常， @Controller 提示如下</p>
			<pre class="screen">
		
{"error":"unauthorized","error_description":"Full authentication is required to access this resource"}		
		
			</pre>
			<p>程序如下</p>
			<pre class="programlisting">
		
package api.controller;

import org.springframework.stereotype.Controller;
import org.springframework.web.bind.annotation.GetMapping;
import org.springframework.web.bind.annotation.RequestMapping;

@Controller
@RequestMapping("/")
public class IndexController {

	public IndexController() {
		// TODO Auto-generated constructor stub
	}

	@GetMapping("/")
	public String index() {
		return "Helloworld!!!";

	}

	@GetMapping("/about")
	public String test() {
		return "Helloworld!!!";

	}
}				
		
			</pre>
			<p>分析 @Controller 不允许直接返回字符串，必须使用 @ResponseBody 或者 ModelAndView，下改后问题解决。</p>
			<pre class="programlisting">
		
package api.controller;

import org.springframework.stereotype.Controller;
import org.springframework.web.bind.annotation.GetMapping;
import org.springframework.web.bind.annotation.RequestMapping;
import org.springframework.web.bind.annotation.ResponseBody;

@Controller
@RequestMapping("/web")
public class IndexController {

	public IndexController() {
		// TODO Auto-generated constructor stub
	}

	@GetMapping("/")
	@ResponseBody
	public String index() {
		return "Helloworld!!!";

	}

	@GetMapping("/about")
	@ResponseBody
	public String test() {
		return "Helloworld!!!";

	}
}

		
			</pre>
			<p>同时 @EnableWebSecurity 需要忽略 @Controller 的映射 URL</p>
			<pre class="programlisting">
			
@Configuration
@EnableWebSecurity
public class WebSecurityConfiguration extends WebSecurityConfigurerAdapter {

	@Override
	public void configure(WebSecurity web) throws Exception {
		web.ignoring().antMatchers("/**/json").antMatchers("/about", "/", "/css/**");
	}
}
			
			</pre>
		</div>
		<div class="section"><div class="titlepage"><div><div><h4 class="title"><a id="idm358989048512"></a>44.1.8. @Value 取不到值</h4></div></div></div>
			
			<p>在构造方法中引用@value为null，由于spring实例化顺序为先执行构造方法，再注入成员变量，所以取值为null。</p>
			<p>调用spring组件时使用new对象，而不是@Autowired。</p>
		</div>
		<div class="section"><div class="titlepage"><div><div><h4 class="title"><a id="faq.springboot.2.1.0"></a>44.1.9. Spring boot 2.1.0</h4></div></div></div>
			
			<p>application.properties 需要加入下面参数，否则 @Bean 不允许。</p>
			<pre class="screen">
		
spring.main.allow-bean-definition-overriding=true		
		
			</pre>
			<p>另外 MySQL驱动必须使用最新的 com.mysql.cj.jdbc.Driver</p>
		</div>
		<div class="section"><div class="titlepage"><div><div><h4 class="title"><a id="idm358989044064"></a>44.1.10. Field authenticationManager in cn.netkiller.oauth2.config.AuthorizationServerConfigurer required a bean of type 'org.springframework.security.authentication.AuthenticationManager' that could not be found.</h4></div></div></div>
			
			<pre class="screen">
		
***************************
APPLICATION FAILED TO START
***************************

Description:

Field authenticationManager in cn.netkiller.oauth2.config.AuthorizationServerConfigurer required a bean of type 'org.springframework.security.authentication.AuthenticationManager' that could not be found.

The injection point has the following annotations:
	- @org.springframework.beans.factory.annotation.Autowired(required=true)


Action:

Consider defining a bean of type 'org.springframework.security.authentication.AuthenticationManager' in your configuration.		
		
			</pre>
			<p>注入 @Bean @Override public AuthenticationManager authenticationManagerBean() 即可解决</p>
			<pre class="screen">
		
package cn.netkiller.oauth2.config;

import org.springframework.context.annotation.Bean;
import org.springframework.context.annotation.Configuration;
import org.springframework.security.authentication.AuthenticationManager;
import org.springframework.security.config.annotation.method.configuration.EnableGlobalMethodSecurity;
import org.springframework.security.config.annotation.web.builders.HttpSecurity;
import org.springframework.security.config.annotation.web.configuration.EnableWebSecurity;
import org.springframework.security.config.annotation.web.configuration.WebSecurityConfigurerAdapter;

@EnableGlobalMethodSecurity(prePostEnabled = true)
@Configuration
@EnableWebSecurity
public class WebSecurityConfigurer extends WebSecurityConfigurerAdapter {

	public WebSecurityConfigurer() {
		// TODO Auto-generated constructor stub
	}

	// 此处必须声明这个bean类，否则无法注入AuthenticationManager
	@Bean
	@Override
	public AuthenticationManager authenticationManagerBean() throws Exception {
		return super.authenticationManagerBean();
	}

	protected void configure(HttpSecurity http) throws Exception {
		http.formLogin().and().authorizeRequests().anyRequest().authenticated().and().logout().permitAll().and().csrf().disable();
	}
}
		
		
			</pre>
		</div>
		<div class="section"><div class="titlepage"><div><div><h4 class="title"><a id="idm358989041168"></a>44.1.11. 打印 Bean 信息</h4></div></div></div>
			
			<pre class="programlisting">
		
import java.util.Arrays;

import org.springframework.boot.CommandLineRunner;
import org.springframework.boot.SpringApplication;
import org.springframework.boot.autoconfigure.SpringBootApplication;
import org.springframework.context.ApplicationContext;
import org.springframework.context.annotation.Bean;

@SpringBootApplication
public class Application {

    public static void main(String[] args) {
        SpringApplication.run(Application.class, args);
    }

    @Bean
    public CommandLineRunner commandLineRunner(ApplicationContext ctx) {
        return args -&gt; {

            System.out.println("Let's inspect the beans provided by Spring Boot:");

            String[] beanNames = ctx.getBeanDefinitionNames();
            Arrays.sort(beanNames);
            for (String beanName : beanNames) {
                System.out.println(beanName);
            }

        };
    }

}		
		
			</pre>
		</div>
		<div class="section"><div class="titlepage"><div><div><h4 class="title"><a id="idm358989039904"></a>44.1.12. The dependencies of some of the beans in the application context form a cycle</h4></div></div></div>
			
			<p>@Service 中的 @Autowired 出现了相互注入，引起循环。</p>
			<pre class="screen">
			
api    | ***************************
api    | APPLICATION FAILED TO START
api    | ***************************
api    | 
api    | Description:
api    | 
api    | The dependencies of some of the beans in the application context form a cycle:
api    | 
api    | ┌─────┐
api    | |  incarOrderFlowServiceImpl defined in URL [jar:file:/app/api.netkiller.cn.jar!/BOOT-INF/lib/api.netkiller.cn-1.0.0.jar!/com/zito/incar/service/impl/IncarOrderFlowServiceImpl.class]
api    | ↑     ↓
api    | |  incarOrderServiceImpl (field private cn.netkiller.service.IIncarAttachService cn.netkiller.service.impl.IncarOrderServiceImpl.iIncarAttachService)
api    | ↑     ↓
api    | |  incarAttachServiceImpl (field private cn.netkiller.service.IIncarOrderFlowService cn.netkiller.service.impl.IncarAttachServiceImpl.iIncarOrderFlowService)
api    | └─────┘
			
			</pre>
			<p>解决方案</p>
			<p>增加 @Lazy 注解</p>
			<pre class="screen">
			
@Slf4j
@Service
@Lazy
public class IncarOrderFlowServiceImpl implements IIncarOrderFlowService {

	@Autowired
	private ISysRoleService iSysRoleService;

	@Autowired
	private  IIncarOrderService iIncarOrderService;	
	...
	...
	...
}	
			
			</pre>
		</div>
		<div class="section"><div class="titlepage"><div><div><h4 class="title"><a id="Could not read document: Invalid UTF-8 middle byte 0xd0"></a>44.1.13. Could not read document: Invalid UTF-8 middle byte 0xd0</h4></div></div></div>
			
			<p>Spring 默认不支持 UTF-8</p>
			<pre class="screen">
		
2016-08-17 16:04:53.148 WARN 7700 --- [nio-8080-exec-1] .w.s.m.s.DefaultHandlerExceptionResolver : Failed to read HTTP message:	org.springframework.http.converter.HttpMessageNotReadableException:Could not read document: Invalid UTF-8 middle byte 0xd0 at [Source: java.io.PushbackInputStream@33aa54cc; line: 1, column: 38](through reference chain: api.domain.oracle.Withdraw["bankname"]); nested exception is 	com.fasterxml.jackson.databind.JsonMappingException: Invalid UTF-8 middle byte 0xd0 at [Source: java.io.PushbackInputStream@33aa54cc; line: 1, column: 38]
			(through reference chain: api.domain.oracle.Withdraw["bankname"])
		
			</pre>
			<p>解决方案 application.properties 配置文件中加入如下配置：</p>
			<pre class="screen">
				spring.messages.encoding=UTF-8
				server.tomcat.uri-encoding=UTF-8
				spring.http.encoding.charset=UTF-8
				spring.http.encoding.enabled=true
				spring.http.encoding.force=true
			</pre>
		</div>

		<div class="section"><div class="titlepage"><div><div><h4 class="title"><a id="idm358989031184"></a>44.1.14. Field javaMailSender in cn.netkiller.rest.EmailRestController
				required a bean of type
				'org.springframework.mail.javamail.JavaMailSender' that could not be
				found.
			</h4></div></div></div>
			
			<p>启动提示 'org.springframework.mail.javamail.JavaMailSender' that
				could not be found 这句话很误导人。实际上是 (spring.mail.host) did not find
				property 'host'
			</p>
			<pre class="screen">
				***************************
				APPLICATION FAILED TO START
				***************************

				Description:

				Field javaMailSender in cn.netkiller.rest.EmailRestController required a
				bean of type 'org.springframework.mail.javamail.JavaMailSender' that
				could not be found.
				- Bean method 'mailSender' not loaded because AnyNestedCondition 0
				matched 2 did not; NestedCondition on
				MailSenderAutoConfiguration.MailSenderCondition.JndiNameProperty
				@ConditionalOnProperty (spring.mail.jndi-name) did not find property
				'jndi-name';
				NestedCondition on
				MailSenderAutoConfiguration.MailSenderCondition.HostProperty
				@ConditionalOnProperty (spring.mail.host) did not find property
				'host'


				Action:

				Consider revisiting the conditions above or defining a bean of type
				'org.springframework.mail.javamail.JavaMailSender' in your
				configuration.
			</pre>
			<p>解决方案，application.properties 增加 spring.mail.host=localhost</p>
		</div>



		<div class="section"><div class="titlepage"><div><div><h4 class="title"><a id="idm358989027632"></a>44.1.15. no main manifest attribute, in /srv/job-admin.jar</h4></div></div></div>
			
			<p></p>
			<pre class="screen">
		
[root@localhost cloud.netkiller.cn]# java -jar job-admin.jar 
no main manifest attribute, in job-admin.jar		
		
			</pre>
			<p>解压 jar 包，查看 META-INF/MANIFEST.MF 文件</p>
			<pre class="screen">
		
[root@localhost ~]# unzip job-admin.jar		
[root@localhost ~]# cat META-INF/MANIFEST.MF 
Manifest-Version: 1.0
Archiver-Version: Plexus Archiver
Built-By: gitlab-runner
Created-By: Apache Maven 3.8.4
Build-Jdk: 1.8.0_312		
		
			</pre>
			<p>解决方法，pom.xml 中增加 repackage 配置项</p>
			<pre class="screen">
		
		&lt;plugins&gt;
            &lt;plugin&gt;
                &lt;groupId&gt;org.springframework.boot&lt;/groupId&gt;
                &lt;artifactId&gt;spring-boot-maven-plugin&lt;/artifactId&gt;
                &lt;version&gt;${spring-boot.version}&lt;/version&gt;
                &lt;executions&gt;
                    &lt;execution&gt;
                        &lt;goals&gt;
                            &lt;goal&gt;repackage&lt;/goal&gt;
                        &lt;/goals&gt;
                    &lt;/execution&gt;
                &lt;/executions&gt;
            &lt;/plugin&gt;
        &lt;/plugins&gt;
		
			</pre>
			<p>重新打包，再解压开查看 MANIFEST.MF 文件</p>
			<pre class="screen">
		
[root@localhost ~]# cat META-INF/MANIFEST.MF 
Manifest-Version: 1.0
Spring-Boot-Classpath-Index: BOOT-INF/classpath.idx
Archiver-Version: Plexus Archiver
Built-By: gitlab-runner
Spring-Boot-Layers-Index: BOOT-INF/layers.idx
Start-Class: cn.netkiller.admin.Application
Spring-Boot-Classes: BOOT-INF/classes/
Spring-Boot-Lib: BOOT-INF/lib/
Spring-Boot-Version: 2.6.2
Created-By: Apache Maven 3.8.4
Build-Jdk: 1.8.0_312
Main-Class: org.springframework.boot.loader.JarLauncher		
		
			</pre>
		</div>
	</div>
	
</div><div xmlns="" id="SOHUCS"></div><script xmlns="" charset="utf-8" type="text/javascript" src="https://cy-cdn.kuaizhan.com/upload/changyan.js"></script><script xmlns="" type="text/javascript">
			window.changyan.api.config({
			appid: 'cyvwjQUG3',
			conf: 'prod_ef966242df3d8b5acb1e0ee9fc01cafe'
			});
</script><script xmlns="" type="text/javascript" id="clustrmaps" src="//cdn.clustrmaps.com/map_v2.js?u=r5HG&amp;d=9mi5r_kkDC8uxG8HuY3p4-2qgeeVypAK9vMD-2P6BYM"></script><div class="navfooter"><hr /><table width="100%" summary="Navigation footer"><tr><td width="40%" align="left"><a accesskey="p" href="../interceptor.html">上一页</a> </td><td width="20%" align="center"><a accesskey="u" href="../index.html">上一级</a></td><td width="40%" align="right"> <a accesskey="n" href="../../webflux/webflux.html">下一页</a></td></tr><tr><td width="40%" align="left" valign="top">43.8. Interceptor/Filter 拦截器/过滤 </td><td width="20%" align="center"><a accesskey="h" href="../../../index.html">起始页</a></td><td width="40%" align="right" valign="top"> 第 45 章 WebFlux framework</td></tr></table></div><script xmlns="">
			(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
		(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
		m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
		})(window,document,'script','//www.google-analytics.com/analytics.js','ga');

			ga('create', 'UA-11694057-1', 'auto');
			ga('send', 'pageview');

		</script><script xmlns="" async="async">
			var _hmt = _hmt || [];
			(function() {
			var hm = document.createElement("script");
			hm.src = "https://hm.baidu.com/hm.js?93967759a51cda79e49bf4e34d0b0f2c";
			var s = document.getElementsByTagName("script")[0];
			s.parentNode.insertBefore(hm, s);
			})();
</script><script xmlns="" async="async">
			(function(){
			var bp = document.createElement('script');
			var curProtocol = window.location.protocol.split(':')[0];
			if (curProtocol === 'https') {
			bp.src = 'https://zz.bdstatic.com/linksubmit/push.js';
			}
			else {
			bp.src = 'http://push.zhanzhang.baidu.com/push.js';
			}
			var s = document.getElementsByTagName("script")[0];
			s.parentNode.insertBefore(bp, s);
			})();
</script></body></html>