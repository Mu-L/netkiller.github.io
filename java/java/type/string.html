<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8" /><title>3.3. String 字符串</title><link rel="stylesheet" type="text/css" href="../../docbook.css" /><meta name="generator" content="DocBook XSL Stylesheets Vsnapshot" /><link rel="home" href="../../index.html" title="Netkiller Java 手札（版）" /><link rel="up" href="index.html" title="第 3 章 数据类型" /><link rel="prev" href="integer.html" title="3.2. Integer 整形" /><link rel="next" href="long.html" title="3.4. 类型转换" /></head><body><a xmlns="" href="//www.netkiller.cn/">Home</a> | <a xmlns="" href="//netkiller.github.io/">简体中文</a> | <a xmlns="" href="http://netkiller.sourceforge.net/">繁体中文</a> | <a xmlns="" href="/journal/index.html">杂文</a>
		| <a xmlns="" href="https://github.com/netkiller">Github</a> | <a xmlns="" href="https://zhuanlan.zhihu.com/netkiller">知乎专栏</a> | <a xmlns="" href="https://www.facebook.com/bg7nyt">Facebook</a> | <a xmlns="" href="http://cn.linkedin.com/in/netkiller/">Linkedin</a> | <a xmlns="" href="https://www.youtube.com/user/bg7nyt/videos">Youtube</a> | <a xmlns="" href="//www.netkiller.cn/home/donations.html">打赏(Donations)</a> | <a xmlns="" href="//www.netkiller.cn/home/about.html">About</a><div class="navheader"><table width="100%" summary="Navigation header"><tr><th colspan="3" align="center">3.3. String 字符串</th></tr><tr><td width="20%" align="left"><a accesskey="p" href="integer.html">上一页</a> </td><th width="60%" align="center">第 3 章 数据类型</th><td width="20%" align="right"> <a accesskey="n" href="long.html">下一页</a></td></tr></table><hr /></div><table xmlns=""><tr><td><iframe src="//ghbtns.com/github-btn.html?user=netkiller&amp;repo=netkiller.github.io&amp;type=watch&amp;count=true&amp;size=large" height="30" width="170" frameborder="0" scrolling="0" style="width:170px; height: 30px;" allowTransparency="true"></iframe></td><td><iframe src="//ghbtns.com/github-btn.html?user=netkiller&amp;repo=netkiller.github.io&amp;type=fork&amp;count=true&amp;size=large" height="30" width="170" frameborder="0" scrolling="0" style="width:170px; height: 30px;" allowTransparency="true"></iframe></td><td><iframe src="//ghbtns.com/github-btn.html?user=netkiller&amp;type=follow&amp;count=true&amp;size=large" height="30" width="240" frameborder="0" scrolling="0" style="width:240px; height: 30px;" allowTransparency="true"></iframe></td><td></td><td><a href="https://zhuanlan.zhihu.com/netkiller"><img src="/images/logo/zhihu-card-default.svg" height="25" /></a></td><td valign="middle"><a href="https://zhuanlan.zhihu.com/netkiller">知乎专栏</a></td><td></td><td></td><td></td><td></td></tr></table><div class="section"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a id="string"></a>3.3. String 字符串</h2></div></div></div>
		
		<p>Java 11 增加了一系列的字符串处理方法，如以下所示。</p>
		<pre class="screen">
		
// 判断字符串是否为空白
" ".isBlank(); // true
// 去除首尾空格
" Javastack ".strip(); // "Javastack"
// 去除尾部空格
" Javastack ".stripTrailing(); // " Javastack"
// 去除首部空格
" Javastack ".stripLeading(); // "Javastack "
		
		</pre>
		<div class="section"><div class="titlepage"><div><div><h3 class="title"><a id="string.indexOf"></a>3.3.1. 查找字符重现的位置</h3></div></div></div>
			
			<pre class="programlisting">
			
package cn.netkiller.test;

public class Test {

	public static void main(String[] args) {

		String string = new String("http://www.netkiller.cn");

		System.out.println("查找字符 . 第一次出现的位置: " + string.indexOf('.'));
		System.out.println("从第15个字符位置查找字符 . 出现的位置:" + string.indexOf('.', 15));
	}
}	
			
			</pre>
		</div>
		<div class="section"><div class="titlepage"><div><div><h3 class="title"><a id="string.line"></a>3.3.2. 行数统计</h3></div></div></div>
			
			<pre class="screen">
			
"A\nB\nC".lines().count(); // 3			
			
			</pre>
		</div>
		<div class="section"><div class="titlepage"><div><div><h3 class="title"><a id="string.repeat"></a>3.3.3. 复制字符串</h3></div></div></div>
			
			<pre class="programlisting">
			
"Java".repeat(3);// "JavaJavaJava"			
			
			</pre>
		</div>
		<div class="section"><div class="titlepage"><div><div><h3 class="title"><a id="random"></a>3.3.4. 随机字符串</h3></div></div></div>
			
			<pre class="programlisting">
			
	public String randomString(String chars, int length) {
		Random rand = new Random();
		StringBuilder buf = new StringBuilder();
		for (int i = 0; i &lt; length; i++) {
			buf.append(chars.charAt(rand.nextInt(chars.length())));
		}
		return buf.toString();
	}
	
	/**
     * 获取4位随机验证码
     * @return
     */
    public static String getValidationCode(){
        return String.valueOf((new Random().nextInt(8999) + 1000));
    }

    /**
     * 获取6位随机验证码
     * @return
     */
    public static String getValidationCode(){
        return String.valueOf((new Random().nextInt(899999) + 100000));
    }	
			
			</pre>
		</div>

		<div class="section"><div class="titlepage"><div><div><h3 class="title"><a id="replace"></a>3.3.5. 字符串替换处理</h3></div></div></div>
			
			<div class="section"><div class="titlepage"><div><div><h4 class="title"><a id="id782"></a>3.3.5.1. 替换转意字符</h4></div></div></div>
				
				<pre class="programlisting">
			
public class Test {

	public Test() {
		// TODO Auto-generated constructor stub
	}

	public static void main(String[] args) {
		// TODO Auto-generated method stub
		System.out.println("2010-09-11T20:00:30".replace("T", " "));
	}
}
			
			
				</pre>
				<pre class="programlisting">
			
{"status":0,"message":"","bankcode":"ABOC;IBC;CCTB;ICBC"}
转换后
{\"status\":0,\"message\":\"\",\"bankcode\":\"ABOC;IBC;CCTB;ICBC\"}			
			
				</pre>
				<pre class="programlisting">
			
package test;

public class str {

	public static void main(String[] args) {
		String jsonString = "{\"status\":0,\"message\":\"\",\"bankcode\":\"ABOC;IBC;CCTB;ICBC\"}";
		System.out.println(jsonString);
		System.out.println(jsonString.replace("\"", "\\\""));
	}

}
			
				</pre>
			</div>
			<div class="section"><div class="titlepage"><div><div><h4 class="title"><a id="id783"></a>3.3.5.2. 替换控制字符</h4></div></div></div>
				
				<pre class="programlisting">
				
str.replaceAll("\\p{Cntrl}", "");				
				
				</pre>
			</div>
			<div class="section"><div class="titlepage"><div><div><h4 class="title"><a id="id784"></a>3.3.5.3. 正则表达式查找与替换</h4></div></div></div>
				
				<p>查找特定字符并替换为找到的内容</p>
				<pre class="programlisting">
				
package cn.netkiller.type;

public class ragexTest {

	public ragexTest() {
		// TODO Auto-generated constructor stub
	}

	public static void main(String[] args) {
		// TODO Auto-generated method stub
		
		String str = "&lt;html&gt;Netkiller&lt;/html&gt;";
		String regex = "&lt;html&gt;|&lt;/html&gt;";
		//运行结果返回 Netkiller
		System.out.println(str.replaceAll(regex, ""));
		
		// 运行结果返回 Neo
		System.out.println("CN/NETKILLER/WWW/Neo_Chen".replaceAll(".*/(.+)_Chen", "$1"));
	}
}
				
				</pre>
			</div>
			<div class="section"><div class="titlepage"><div><div><h4 class="title"><a id="id785"></a>3.3.5.4. 利用正则快速转换时间格式</h4></div></div></div>
				
				<pre class="programlisting">
				
// 20200303 =&gt; 2020-03-03
date = date.replace(/(.{4})/, "$1-");
date = date.replace(/(.{7})/, "$1-");				
				
				</pre>
				<p>用正则处理 Alertmanager 日期 rfc3339 格式
					2021-08-23T01:30:30.2206015+08:00，Alertmanager 日期格式中有7位数的毫秒，使用
					SimpleDateFormat("yyyy-MM-dd'T'HH:mm:ss.SSSXXX") 无法正常读取。
				</p>
				<pre class="programlisting">
				
package cn.netkiller.alertmanager;

import java.text.ParseException;
import java.text.SimpleDateFormat;
import java.util.TimeZone;

public class Test {

	public Test() {
		// TODO Auto-generated constructor stub
	}

	public static void main(String[] args) throws ParseException {
		// TODO Auto-generated method stub
		String rfc3339 = "2021-08-23T01:30:30.2206015+08:00";
		rfc3339 = rfc3339.replaceAll(".[0-9]{7}", "");

		System.out.println(rfc3339);
		System.out.println(rfc3339.replaceAll("([0-9]{4})-([0-9]{2})-([0-9]{2})T([0-9]{2}):([0-9]{2}):([0-9]{2})+(.*)", "$1年$2月$3日 $4时$5分$6秒"));
		System.out.println(rfc3339.replaceAll("([0-9]{4}-[0-9]{2}-[0-9]{2})T([0-9]{2}:[0-9]{2}:[0-9]{2})+(.+)", "日期：$1 时间：$2"));

		// SimpleDateFormat simpleDateFormat = new SimpleDateFormat("yyyy-MM-dd'T'HH:mm:ss.SSSXXX");
		SimpleDateFormat simpleDateFormat = new SimpleDateFormat("yyyy-MM-dd'T'HH:mm:ssXXX");
		simpleDateFormat.setTimeZone(TimeZone.getTimeZone("GMT+8"));
		System.out.println(simpleDateFormat.parse(rfc3339).toString());

	}

}				
				
				</pre>
				<pre class="screen">
				
2021-08-23T01:30:30+08:00
2021年08月23日 01时30分30秒
日期：2021-08-23 时间：01:30:30
Mon Aug 23 01:30:30 CST 2021				
				
				</pre>
			</div>

			<div class="section"><div class="titlepage"><div><div><h4 class="title"><a id="string.replaceAll"></a>3.3.5.5. replaceAll</h4></div></div></div>
				
				<p>替换一组字符串</p>
				<pre class="programlisting">
				
        String str1 = "广东省，福建省，北京市，海淀区，河北省，上海市";
        str1 = str1.replaceAll("(省|市|区)", "");
        System.out.println("替换多个中文：" + str1);
        
        替换多个中文：广东，福建，北京，海淀，河北，上海				
				
				</pre>
				<p>替换 Ascii</p>
				<pre class="programlisting">
			
		String string = "佛山市123南海区ABC精密abc机械有限公司􁵪􁻠􁴹􄲀􀞜􀨨,";

		String clean = string.replaceAll("\\P{Print}", "");
		System.out.println(clean);			
			
				</pre>
			</div>
			<div class="section"><div class="titlepage"><div><div><h4 class="title"><a id="string.unicode"></a>3.3.5.6. 字符串处理，删除中文以外的字符</h4></div></div></div>
				
				<p>Unicode 码表 https://www.ssec.wisc.edu/~tomw/java/unicode.html
				</p>
				<pre class="programlisting">
			
	String string = "2017-12-18 netkiller http://www.netkiller.cn -  网站正常";
	System.out.println(string.replaceAll("[^\u4e00-\u9fa5]", ""));			
			
				</pre>
			</div>
			<div class="section"><div class="titlepage"><div><div><h4 class="title"><a id="string.regex"></a>3.3.5.7. 取出字符串中的中文字符</h4></div></div></div>
				
				<p>Unicode 码表 https://www.ssec.wisc.edu/~tomw/java/unicode.html
				</p>
				<pre class="programlisting">
			
		String string = "2017-12-18 netkiller http://www.netkiller.cn -  网站正常";
		String regex = "[\u4e00-\u9fa5]";
		System.out.println(string.replaceAll(regex, ""));			
			
				</pre>
			</div>
			<div class="section"><div class="titlepage"><div><div><h4 class="title"><a id="id786"></a>3.3.5.8. 查找替换末尾最后一个字符</h4></div></div></div>
				
				<pre class="programlisting">
				
package cn.netkiller.test;

import java.util.List;

public class Test {


    public Test() {
    }

    public static String replaceEnd(String string) {
        
        char c = string.charAt(string.length() - 1);
        if (List.of('，', ',', '、').contains(c)) {
            string = string.substring(0, string.length() - 1);
        }

        return string;
    }

    public static void main(String[] args) throws Exception {
        List.of("你好！", "你好,中国，", "Hello,", "Hello world!", "你在干啥么吗？没看到吗？", "这里真好").forEach(s -&gt; {
            System.out.println(replaceEnd(s));
        });

    }
    
}
				
				</pre>
				<pre class="screen">
				
你好！
你好,中国
Hello
Hello world!
你在干啥么吗？没看到吗？
这里真好
				
				</pre>
			</div>
			
		</div>
		<div class="section"><div class="titlepage"><div><div><h3 class="title"><a id="substring"></a>3.3.6. substring</h3></div></div></div>
			
			<pre class="programlisting">
			
例如：
String str = "helloword!!!";

System.out.println(str.substring(1,4));

System.out.println(str.substring(3,5));

System.out.println(str.substring(0,4));

将得到结果为：

ell

lo 

hell
			
			</pre>
		</div>
		<div class="section"><div class="titlepage"><div><div><h3 class="title"><a id="string2tempstamp"></a>3.3.7. string to timestamp</h3></div></div></div>
			
			<p>Timestamp转化为String:</p>
			<pre class="programlisting">
				SimpleDateFormat df = new
				SimpleDateFormat("yyyy-MM-dd HH:mm:ss"); //定义格式，不显示毫秒
				Timestamp now =
				new Timestamp(System.currentTimeMillis());
				//获取系统当前时间
				String str =
				df.format(now);
			</pre>
			<p>String转化为Timestamp:</p>
			<pre class="programlisting">
				SimpleDateFormat df = new
				SimpleDateFormat("yyyy-MM-dd HH:mm:ss");
				String time = df.format(new
				Date());
				Timestamp ts = Timestamp.valueOf(time);
			</pre>
		</div>
		<div class="section"><div class="titlepage"><div><div><h3 class="title"><a id="String.strip"></a>3.3.8. String.strip</h3></div></div></div>
			
			<p>java11对String类新增了strip，stripLeading以及stripTrailing方法，除了strip相关的方法还新增了isBlank、lines、repeat(int)等方法
			</p>
			<pre class="screen">
			
	@Test
    public void testStrip(){
        String text = "  \u2000a  b  ";
        Assert.assertEquals("a  b",text.strip());
        Assert.assertEquals("\u2000a  b",text.trim());
        Assert.assertEquals("a  b  ",text.stripLeading());
        Assert.assertEquals("  \u2000a  b",text.stripTrailing());
    }
			
			</pre>
		</div>
		<div class="section"><div class="titlepage"><div><div><h3 class="title"><a id="string.block"></a>3.3.9. 文本块</h3></div></div></div>
			
			<pre class="programlisting">
			
package cn.netkiller.kubernetes;

public class Test {

	public Test() {
	}

	public static void main(String[] args) {

		String json = """
				{
				"name" : "netkiller",
				"home" : "https://www.netkiller.cn/"
				}
				""";
		System.out.println(json);
	}

}			
			
			</pre>
		</div>
		<div class="section"><div class="titlepage"><div><div><h3 class="title"><a id="string.split"></a>3.3.10. 分割字符串</h3></div></div></div>
			

			<pre class="screen">
			
        String[] string = topic.split("/");
        Log.d("Service", string.length + "");
        for (String str: string) {
            Log.d("Service", str);
        }		
        
		String str2 = new String("www.netkiller.cn");
        for (String retval: str2.split("\\.", 3)){
            System.out.println(retval);
        }
 
        System.out.println("");
        String str3 = new String("acount=? and uu =? or n=?");
        for (String retval: str3.split("and|or")){
            System.out.println(retval);
        }                
			
			</pre>
		</div>
		<div class="section"><div class="titlepage"><div><div><h3 class="title"><a id="stream().anyMatch()"></a>3.3.11. 通过 stream() 匹配一组字符串</h3></div></div></div>
			
			<pre class="programlisting">
			
		String str1 = "Hello, World!";
        List&lt;String&gt; str2 = Arrays.asList("World", "Hello");

        boolean contains = str2.stream().anyMatch(str1::contains);
        System.out.println("找到字符串：" + contains);			
			
			</pre>
		</div>
	</div><script xmlns="" type="text/javascript" id="clustrmaps" src="//cdn.clustrmaps.com/map_v2.js?u=r5HG&amp;d=9mi5r_kkDC8uxG8HuY3p4-2qgeeVypAK9vMD-2P6BYM"></script><div class="navfooter"><hr /><table width="100%" summary="Navigation footer"><tr><td width="40%" align="left"><a accesskey="p" href="integer.html">上一页</a> </td><td width="20%" align="center"><a accesskey="u" href="index.html">上一级</a></td><td width="40%" align="right"> <a accesskey="n" href="long.html">下一页</a></td></tr><tr><td width="40%" align="left" valign="top">3.2. Integer 整形 </td><td width="20%" align="center"><a accesskey="h" href="../../index.html">起始页</a></td><td width="40%" align="right" valign="top"> 3.4. 类型转换</td></tr></table></div><script xmlns="">
			(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
		(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
		m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
		})(window,document,'script','//www.google-analytics.com/analytics.js','ga');

			ga('create', 'UA-11694057-1', 'auto');
			ga('send', 'pageview');

		</script><script xmlns="" async="async">
			var _hmt = _hmt || [];
			(function() {
			var hm = document.createElement("script");
			hm.src = "https://hm.baidu.com/hm.js?93967759a51cda79e49bf4e34d0b0f2c";
			var s = document.getElementsByTagName("script")[0];
			s.parentNode.insertBefore(hm, s);
			})();
</script><script xmlns="" async="async">
			(function(){
			var bp = document.createElement('script');
			var curProtocol = window.location.protocol.split(':')[0];
			if (curProtocol === 'https') {
			bp.src = 'https://zz.bdstatic.com/linksubmit/push.js';
			}
			else {
			bp.src = 'http://push.zhanzhang.baidu.com/push.js';
			}
			var s = document.getElementsByTagName("script")[0];
			s.parentNode.insertBefore(bp, s);
			})();
</script></body></html>