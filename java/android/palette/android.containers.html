<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8" /><title>113.8. Containers</title><link rel="stylesheet" type="text/css" href="../../docbook.css" /><meta name="generator" content="DocBook XSL Stylesheets Vsnapshot" /><link rel="home" href="../../index.html" title="Netkiller Java 手札（版）" /><link rel="up" href="index.html" title="第 113 章 Palette 视觉设计" /><link rel="prev" href="ch113s07.html" title="113.7. Widgets" /><link rel="next" href="android.display.html" title="113.9. 屏幕" /></head><body><a xmlns="" href="//www.netkiller.cn/">Home</a> | <a xmlns="" href="//netkiller.github.io/">简体中文</a> | <a xmlns="" href="http://netkiller.sourceforge.net/">繁体中文</a> | <a xmlns="" href="/journal/index.html">杂文</a>
		| <a xmlns="" href="https://github.com/netkiller">Github</a> | <a xmlns="" href="https://zhuanlan.zhihu.com/netkiller">知乎专栏</a> | <a xmlns="" href="https://www.facebook.com/bg7nyt">Facebook</a> | <a xmlns="" href="http://cn.linkedin.com/in/netkiller/">Linkedin</a> | <a xmlns="" href="https://www.youtube.com/user/bg7nyt/videos">Youtube</a> | <a xmlns="" href="//www.netkiller.cn/home/donations.html">打赏(Donations)</a> | <a xmlns="" href="//www.netkiller.cn/home/about.html">About</a><div class="navheader"><table width="100%" summary="Navigation header"><tr><th colspan="3" align="center">113.8. Containers</th></tr><tr><td width="20%" align="left"><a accesskey="p" href="ch113s07.html">上一页</a> </td><th width="60%" align="center">第 113 章 Palette 视觉设计</th><td width="20%" align="right"> <a accesskey="n" href="android.display.html">下一页</a></td></tr></table><hr /></div><table xmlns=""><tr><td><iframe src="//ghbtns.com/github-btn.html?user=netkiller&amp;repo=netkiller.github.io&amp;type=watch&amp;count=true&amp;size=large" height="30" width="170" frameborder="0" scrolling="0" style="width:170px; height: 30px;" allowTransparency="true"></iframe></td><td><iframe src="//ghbtns.com/github-btn.html?user=netkiller&amp;repo=netkiller.github.io&amp;type=fork&amp;count=true&amp;size=large" height="30" width="170" frameborder="0" scrolling="0" style="width:170px; height: 30px;" allowTransparency="true"></iframe></td><td><iframe src="//ghbtns.com/github-btn.html?user=netkiller&amp;type=follow&amp;count=true&amp;size=large" height="30" width="240" frameborder="0" scrolling="0" style="width:240px; height: 30px;" allowTransparency="true"></iframe></td><td></td><td><a href="https://zhuanlan.zhihu.com/netkiller"><img src="/images/logo/zhihu-card-default.svg" height="25" /></a></td><td valign="middle"><a href="https://zhuanlan.zhihu.com/netkiller">知乎专栏</a></td><td></td><td></td><td></td><td></td></tr></table><div class="section"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a id="android.containers"></a>113.8. Containers</h2></div></div></div>
	
	<div class="section"><div class="titlepage"><div><div><h3 class="title"><a id="CardView"></a>113.8.1. CardView</h3></div></div></div>
		
		<div class="section"><div class="titlepage"><div><div><h4 class="title"><a id="id1859"></a>113.8.1.1. 实现圆角 ImageView</h4></div></div></div>
			
			<pre class="programlisting">
			
&lt;?xml version="1.0" encoding="utf-8"?&gt;
&lt;androidx.constraintlayout.widget.ConstraintLayout xmlns:android="http://schemas.android.com/apk/res/android"
    xmlns:app="http://schemas.android.com/apk/res-auto"
    xmlns:tools="http://schemas.android.com/tools"
    android:layout_width="match_parent"
    android:layout_height="match_parent"&gt;

    &lt;androidx.cardview.widget.CardView
        android:layout_width="wrap_content"
        android:layout_height="wrap_content"
        app:cardCornerRadius="10dp"
        app:cardElevation="0dp"
        tools:ignore="MissingConstraints"&gt;

        &lt;ImageView
            android:id="@+id/imageView7"
            android:layout_width="wrap_content"
            android:layout_height="wrap_content"
            android:scaleType="fitXY"
            app:srcCompat="@drawable/bg_repast_menu" /&gt;
    &lt;/androidx.cardview.widget.CardView&gt;
&lt;/androidx.constraintlayout.widget.ConstraintLayout&gt;			
			
			</pre>
		</div>
	</div>
	<div class="section"><div class="titlepage"><div><div><h3 class="title"><a id="RecyclerView"></a>113.8.2. RecyclerView</h3></div></div></div>
		
		<div class="section"><div class="titlepage"><div><div><h4 class="title"><a id="id1860"></a>113.8.2.1. 滚动到最底部</h4></div></div></div>
			
			<pre class="programlisting">
			
        linearLayoutManager = new LinearLayoutManager(ContextHolder.getContext());
        linearLayoutManager.setStackFromEnd(true);
        recyclerView.setLayoutManager(linearLayoutManager);
        recyclerView.scrollToPosition(adapter.getItemCount() - 1);
			
			</pre>
			<p>调用下面函数</p>
			<pre class="programlisting">
			
recyclerView.smoothScrollToPosition(adapter.getItemCount() - 1);			
			
			</pre>
			<p>其他用法</p>
			<pre class="programlisting">
			
//                        linearLayoutManager.scrollToPositionWithOffset(adapter.getItemCount() - 1, Integer.MIN_VALUE);
//                        linearLayoutManager.scrollToPosition(adapter.getItemCount() - 1);
			
			</pre>
		</div>
		<div class="section"><div class="titlepage"><div><div><h4 class="title"><a id="id1861"></a>113.8.2.2. ItemView 禁止自适应</h4></div></div></div>
			
			<pre class="programlisting">
			
        @NonNull
        @Override
        public ViewHolder onCreateViewHolder(@NonNull ViewGroup parent, int viewType) {
//            View view = View.inflate(MainApplication.getContext(), R.layout.recycler_view_chat, null); 这种方式，Item 不会100%充满屏幕
            View view = LayoutInflater.from(MainApplication.getContext()).inflate(R.layout.recycler_view_chat, parent, false);
            ViewHolder viewHolder = new ViewHolder(view);
            return viewHolder;
        }
			
			</pre>
		</div>
		<div class="section"><div class="titlepage"><div><div><h4 class="title"><a id="id1862"></a>113.8.2.3. 滚动条</h4></div></div></div>
			
			<p>判断是否滑动到顶部/底部：</p>
			<pre class="programlisting">
			
@Override
public void onScrollStateChanged(@NonNull RecyclerView recyclerView, int newState) {
    if(newState == RecyclerView.SCROLL_STATE_IDLE){//停止滑动
        if(recyclerView.canScrollVertically(1)){
            Log.d(TAG, "滑动到顶部");
        }
        if(recyclerView.canScrollVertically(-1)){
            Log.d(TAG, "滑动到底部");
        }
    }
    super.onScrollStateChanged(recyclerView, newState);
}

recyclerView.canScrollVertically(1);  false表示不能往上滑动，即代表到顶部了；
recyclerView.canScrollVertically(-1); false表示不能往下滑动，即代表到底部了；
			
			</pre>
			<p>判断滑动方向</p>
			<pre class="programlisting">
			
@Override
public void onScrolled(@NonNull RecyclerView recyclerView, int dx, int dy) {
    if (dy &gt; 0) {//下滑动作
    }

    if (dy &lt; 0) {//上滑动作
    }
    super.onScrolled(recyclerView, dx, dy);
}

			
			</pre>
			<p>保存滚动条位置</p>
			<pre class="programlisting">
			
// Save state
Parcelable recyclerViewState = recyclerView.getLayoutManager().onSaveInstanceState();

// Todo

// Restore state
recyclerView.getLayoutManager().onRestoreInstanceState(recyclerViewState);
			
			</pre>
		</div>
		<div class="section"><div class="titlepage"><div><div><h4 class="title"><a id="id1863"></a>113.8.2.4. 子视图操作</h4></div></div></div>
			
			<pre class="programlisting">
			
    View view = binding.recyclerView.getChildAt(0);
    TextView textView = view.findViewById(R.id.textViewQuestion);
    textView.setText("Hello");			
			
			</pre>
		</div>
		<div class="section"><div class="titlepage"><div><div><h4 class="title"><a id="id1864"></a>113.8.2.5. 水平布局</h4></div></div></div>
			
			<pre class="programlisting">
			
	LinearLayoutManager linearLayoutManager = new LinearLayoutManager(requireContext(), LinearLayoutManager.HORIZONTAL, false);
	binding.recyclerView.setLayoutManager(linearLayoutManager);
			
			</pre>
		</div>
		<div class="section"><div class="titlepage"><div><div><h4 class="title"><a id="id1865"></a>113.8.2.6. 遍历所有子试图</h4></div></div></div>
			
			<pre class="programlisting">
			
	RecyclerView.LayoutManager layoutManager = binding.loraRecyclerView.getLayoutManager();
    int childCount = layoutManager.getChildCount();
    for (int i = 0; i &lt; childCount; i++) {
        View childView = layoutManager.getChildAt(i);
        TextView nameTextView = childView.findViewById(R.id.nameTextView);
        nameTextView.setBackgroundColor(Color.WHITE);
        nameTextView.setTextColor(Color.BLACK);
    }			
			
			</pre>
		</div>
	</div>
	<div class="section"><div class="titlepage"><div><div><h3 class="title"><a id="NavigationView"></a>113.8.3. NavigationView</h3></div></div></div>
		
		<pre class="programlisting">
		
    &lt;com.google.android.material.navigation.NavigationView
        android:id="@+id/navigationView"
        android:layout_width="wrap_content"
        android:layout_height="match_parent"
        android:layout_gravity="start"
        app:headerLayout="@layout/navigation_header"
        app:menu="@menu/navigation" /&gt;
		
		</pre>
		<pre class="programlisting">
		
&lt;?xml version="1.0" encoding="utf-8"?&gt;
&lt;menu xmlns:android="http://schemas.android.com/apk/res/android"&gt;
    &lt;!--    &lt;group android:checkableBehavior="single"&gt;--&gt;
    &lt;!--        &lt;item--&gt;
    &lt;!--            android:id="@+id/fragment_05"--&gt;
    &lt;!--            android:title="界面1" /&gt;--&gt;
    &lt;!--        &lt;item--&gt;
    &lt;!--            android:id="@+id/fragment_06"--&gt;
    &lt;!--            android:title="界面2" /&gt;--&gt;
    &lt;!--        &lt;item--&gt;
    &lt;!--            android:id="@+id/fragment_07"--&gt;
    &lt;!--            android:title="界面3" /&gt;--&gt;
    &lt;!--    &lt;/group&gt;--&gt;
    &lt;group android:id="@+id/groupAi"&gt;
        &lt;item
            android:id="@+id/fragment_share"
            android:icon="@drawable/menu_community"
            android:title="@string/discovery" /&gt;
        &lt;item
            android:id="@+id/menu_story"
            android:icon="@drawable/menu_story"
            android:title="@string/story" /&gt;
        &lt;item
            android:id="@+id/menu_chat"
            android:icon="@drawable/menu_chat"
            android:title="@string/chat" /&gt;
    &lt;/group&gt;
    &lt;group android:id="@+id/debug" android:visible="false"&gt;

        &lt;item
            android:id="@+id/fragment_09"
            android:icon="@drawable/menu_like"
            android:title="点赞作品" /&gt;
        &lt;item
            android:id="@+id/menu_home"
            android:icon="@drawable/menu_favorites"
            android:title="收藏作品"/&gt;
        &lt;!--    &lt;/group&gt;--&gt;
        &lt;!--    &lt;group android:id="@+id/group_two" &gt;--&gt;

        &lt;item
            android:id="@+id/menu_pictur_book"
            android:icon="@drawable/menu_book"
            android:title="@string/pictur_book"
            /&gt;

    &lt;/group&gt;
    &lt;group android:id="@+id/groupSetting"&gt;
        &lt;item
            android:id="@+id/fragment_bind"
            android:icon="@drawable/menu_bind"
            android:title="@string/device" /&gt;
        &lt;item
            android:id="@+id/fragment_notification"
            android:icon="@android:drawable/ic_popup_reminder"
            android:title="消息通知" /&gt;
        &lt;item
            android:id="@+id/menu_about"
            android:icon="?android:attr/actionModeFindDrawable"
            android:title="@string/about" /&gt;

        &lt;item
            android:id="@+id/menu_quit"
            android:icon="@drawable/menu_quit"
            android:title="退出" /&gt;
    &lt;/group&gt;
&lt;/menu&gt;
		
		</pre>
		<div class="section"><div class="titlepage"><div><div><h4 class="title"><a id="id1866"></a>113.8.3.1. 菜单的显示/隐藏</h4></div></div></div>
			
			<p>菜单项目的显示和隐藏</p>
			<pre class="programlisting">
			
            MenuItem menuItem = findViewById(R.id.debug);
            menuItem.setVisible(true);
			
			</pre>
			<p>菜单组的显示/隐藏</p>
			<pre class="programlisting">
			
            Menu menuGroup = navigationView.getMenu();
            menuGroup.setGroupVisible(R.id.debug, true);
			
			</pre>
			
		</div>
	</div>
	<div class="section"><div class="titlepage"><div><div><h3 class="title"><a id="BottomNavigationView"></a>113.8.4. 底部导航</h3></div></div></div>
		
		<p>只显示图标，不显示文字 app:labelVisibilityMode="unlabeled"</p>
		<pre class="programlisting">
		
            &lt;com.google.android.material.bottomnavigation.BottomNavigationView
                android:id="@+id/nav_view"
                android:layout_width="match_parent"
                android:layout_height="40dp"
                android:background="@android:color/system_neutral2_50"
                app:itemIconTint="@drawable/navigation_view"
                app:labelVisibilityMode="unlabeled"
                app:menu="@menu/bottom_nav_menu"
                tools:ignore="NewApi" /&gt;		
		
		</pre>
		<pre class="programlisting">
		
.setLabelVisibilityMode(LabelVisibilityMode.LABEL_VISIBILITY_LABELED);
		
		</pre>
		<p>图标不显示原始颜色</p>
		<pre class="programlisting">
		
setItemIconTintList(null)		
		
		</pre>
		<p>文字上下移动，app:itemPaddingBottom="15dp"，app:itemPaddingTop="0dp"
		</p>
		<pre class="programlisting">
		
            &lt;com.google.android.material.bottomnavigation.BottomNavigationView
                android:id="@+id/nav_view"
                android:layout_width="match_parent"
                android:layout_height="40dp"
                android:background="@android:color/system_neutral2_50"
                android:gravity="center"
                app:itemPaddingBottom="15dp"
                app:itemTextColor="@color/black"
                app:labelVisibilityMode="labeled"
                app:menu="@menu/bottom_nav_menu"
                tools:ignore="NewApi" /&gt;
		
		</pre>
		<div class="section"><div class="titlepage"><div><div><h4 class="title"><a id="id1867"></a>113.8.4.1. 选中菜单</h4></div></div></div>
			
			<pre class="programlisting">
			
binding.bottomNavigationView.setSelectedItemId(binding.bottomNavigationView.getMenu().getItem(3).getItemId());			
			
			</pre>
		</div>
	</div>
	<div class="section"><div class="titlepage"><div><div><h3 class="title"><a id="TabLayout"></a>113.8.5. TabLayout</h3></div></div></div>
		
		<div class="section"><div class="titlepage"><div><div><h4 class="title"><a id="id1868"></a>113.8.5.1. xml 布局</h4></div></div></div>
			
			<pre class="programlisting">
			
		&lt;com.google.android.material.tabs.TabLayout
                android:id="@+id/tabLayout"
                android:layout_width="match_parent"
                android:layout_height="wrap_content"&gt;

                &lt;com.google.android.material.tabs.TabItem
                    android:layout_width="wrap_content"
                    android:layout_height="wrap_content"
                    android:text="消息" /&gt;

                &lt;com.google.android.material.tabs.TabItem
                    android:layout_width="wrap_content"
                    android:layout_height="wrap_content"
                    android:text="审核" /&gt;
                
            &lt;/com.google.android.material.tabs.TabLayout&gt;
            
        &lt;androidx.fragment.app.FragmentContainerView
            android:id="@+id/fragmentContainerViewTabItem"
            android:name="cn.netkiller.student.ui.message.NotificationFullscreenFragment"
            android:layout_width="match_parent"
            android:layout_height="match_parent"
            android:layout_weight="1"
            android:fitsSystemWindows="true" /&gt;
			
			</pre>
		</div>
		<div class="section"><div class="titlepage"><div><div><h4 class="title"><a id="id1869"></a>113.8.5.2. OnTabSelectedListener 事件</h4></div></div></div>
			
			<pre class="programlisting">
			
		binding.tabLayout.addOnTabSelectedListener(new TabLayout.OnTabSelectedListener() {
            // 页面被选中
            @Override
            public void onTabSelected(TabLayout.Tab tab) {
                Log.d(TAG, "onTabSelected: " + tab.getText());
                Fragment fragment = null;
                switch (tab.getPosition()) {
                    // 这里我随便写了两个Fragment
                    case 0:
                        fragment = new NotificationFullscreenFragment();
                        break;
                    case 1:
                        fragment = new AuditFragment();
                        break;
                }

                if (fragment != null) {
                    getActivity().getSupportFragmentManager().beginTransaction().replace(R.id.fragmentContainerViewTabItem, fragment).commit();
                }
            }

            // 页面切换到其他
            @Override
            public void onTabUnselected(TabLayout.Tab tab) {
                Log.d(TAG, "onTabUnselected: " + tab.getText());
            }

            @Override
            public void onTabReselected(TabLayout.Tab tab) {
                Log.d(TAG, "onTabReselected: " + tab.getText());
            }
        });
			
			</pre>
		</div>
		<div class="section"><div class="titlepage"><div><div><h4 class="title"><a id="id1870"></a>113.8.5.3. 防止快速点击切换</h4></div></div></div>
			
			<pre class="programlisting">
			
binding.tabLayout.addOnTabSelectedListener(new TabLayout.OnTabSelectedListener() {
            private boolean isOnTabSelectedListener = false;

            @Override
            public void onTabSelected(TabLayout.Tab tab) {

                if (isOnTabSelectedListener) {
                    Log.e(TAG, "onTabSelected: 暴击 " + tab.getText());
                    return;
                } else {
                    new Handler(Looper.getMainLooper()).postDelayed(new Runnable() {
                        public void run() {
                            isOnTabSelectedListener = false;
                            Log.e(TAG, "Tab 释放");
                        }
                    }, 5000);
                    isOnTabSelectedListener = true;
                }
                Log.d(TAG, "onTabSelected: " + tab.getText());
                Fragment fragment = null;
                switch (tab.getPosition()) {
                    case 0:
                        fragment = new NoticeFragment();
                        break;
                    case 1:
                        fragment = new MessageFragment();
                        break;
                    case 2:
                        fragment = new AuditFragment();
                        break;
                }

                if (fragment != null) {
                    try {
                        if (!isAdded()) return;
//                        requireActivity().getSupportFragmentManager().beginTransaction().replace(R.id.fragmentContainerViewTabItem, fragment).commit();
                        getChildFragmentManager().beginTransaction().replace(R.id.fragmentContainerViewTabItem, fragment).commitAllowingStateLoss();
                    } catch (Exception e) {
                        Log.d(TAG, "Tab 切换出错" + e.getMessage());
                    }

                }
            }

            // 页面切换到其他
            @Override
            public void onTabUnselected(TabLayout.Tab tab) {
                Log.d(TAG, "onTabUnselected: " + tab.getText());
            }

            @Override
            public void onTabReselected(TabLayout.Tab tab) {
                Log.d(TAG, "onTabReselected: " + tab.getText());
            }
        });
			
			</pre>
			<p>增加间隔时间，并且恢复最后一次点击位置的操作</p>
			<pre class="programlisting">
			
    private void switchTabLayout(int position) {
        Fragment fragment = null;
        switch (position) {
            case 0:
                fragment = new NoticeFragment();
                break;
            case 1:
                fragment = new MessageFragment();
                break;
            case 2:
                fragment = new AuditFragment();
                break;
        }

        if (fragment != null) {
            try {
                if (!isAdded()) return;
//                        requireActivity().getSupportFragmentManager().beginTransaction().replace(R.id.fragmentContainerViewTabItem, fragment).commit();
                getChildFragmentManager().beginTransaction().replace(R.id.fragmentContainerViewTabItem, fragment).commitAllowingStateLoss();
            } catch (Exception e) {
                Log.d(TAG, "Tab 切换出错" + e.getMessage());
            }

        }
    }			
			
		binding.tabLayout.addOnTabSelectedListener(new TabLayout.OnTabSelectedListener() {
            private final long interval = 1000L;
            private boolean isOnTabSelectedListener = false;
            private int index = 0;

            @Override
            public void onTabSelected(TabLayout.Tab tab) {
                index = tab.getPosition();
                if (isOnTabSelectedListener) {
                    Log.e(TAG, "onTabSelected: 暴击 " + tab.getText() + " 位置: " + index);
                    return;
                } else {
                    new Handler(Looper.getMainLooper()).postDelayed(new Runnable() {
                        public void run() {
                            isOnTabSelectedListener = false;
                            switchTabLayout(index);

                            Log.e(TAG, "Tab 释放，并且切换最后一次点击位置: " + index + " - " + tab.getPosition());
                        }
                    }, interval);

                    isOnTabSelectedListener = true;
                }
                Log.d(TAG, "onTabSelected: " + tab.getText());
                switchTabLayout(tab.getPosition());
            }

            // 页面切换到其他
            @Override
            public void onTabUnselected(TabLayout.Tab tab) {
                Log.d(TAG, "onTabUnselected: " + tab.getText());
            }

            @Override
            public void onTabReselected(TabLayout.Tab tab) {
                Log.d(TAG, "onTabReselected: " + tab.getText());
            }
        });	
			
			</pre>
		</div>
	</div>
	<div class="section"><div class="titlepage"><div><div><h3 class="title"><a id="ViewPager2"></a>113.8.6. ViewPager2</h3></div></div></div>
		
		<pre class="programlisting">
		
    &lt;androidx.viewpager2.widget.ViewPager2
        android:id="@+id/viewPager2"
        android:layout_width="match_parent"
        android:layout_height="match_parent" /&gt;
		
		</pre>
		<p>view_page_layout.xml 文件</p>
		<pre class="programlisting">
		
&lt;?xml version="1.0" encoding="utf-8"?&gt;
&lt;LinearLayout xmlns:android="http://schemas.android.com/apk/res/android"
    android:layout_width="match_parent"
    android:layout_height="match_parent"&gt;

    &lt;TextView
        android:id="@+id/textView"
        android:layout_width="wrap_content"
        android:layout_height="wrap_content"
        android:layout_weight="1"
        android:text="TextView" /&gt;
&lt;/LinearLayout&gt;
		
		</pre>
		<pre class="programlisting">
		
	private List&lt;String&gt; items = List.of("A", "B", "C");		
		
	@Override
    public void onViewCreated(@NonNull View view, @Nullable Bundle savedInstanceState) {
        super.onViewCreated(view, savedInstanceState);
        binding.viewPager2.setAdapter(new ViewPagerAdapter());
    }
		
		</pre>
		<pre class="programlisting">
		
    public class ViewPagerAdapter extends RecyclerView.Adapter&lt;ViewPagerAdapter.CardViewHolder&gt; {

        @NonNull
        @Override
        public ViewPagerAdapter.CardViewHolder onCreateViewHolder(@NonNull ViewGroup parent, int viewType) {
            return new CardViewHolder(LayoutInflater.from(parent.getContext()).inflate(R.layout.view_page_layout, parent, false));
        }

        @Override
        public void onBindViewHolder(@NonNull ViewPagerAdapter.CardViewHolder holder, int position) {
            holder.textView.setText(items.get(position));
        }

        @Override
        public int getItemCount() {
            return items.size();
        }

        public class CardViewHolder extends RecyclerView.ViewHolder {

            public TextView textView;

            public CardViewHolder(@NonNull View itemView) {
                super(itemView);
                textView = itemView.findViewById(R.id.textView);
            }
        }
    }
		
		</pre>
		<div class="section"><div class="titlepage"><div><div><h4 class="title"><a id="id1871"></a>113.8.6.1. ViewPager2 with Fragments</h4></div></div></div>
			
			<pre class="programlisting">
			
    &lt;com.google.android.material.tabs.TabLayout
        android:id="@+id/tabLayout"
        android:layout_width="match_parent"
        android:layout_height="wrap_content"&gt;

        &lt;com.google.android.material.tabs.TabItem
            android:layout_width="wrap_content"
            android:layout_height="wrap_content"
            android:text="推荐" /&gt;

    &lt;/com.google.android.material.tabs.TabLayout&gt;

    &lt;androidx.viewpager2.widget.ViewPager2
        android:id="@+id/viewPager2"
        android:layout_width="match_parent"
        android:layout_height="match_parent" /&gt;
			
			</pre>
			<pre class="programlisting">
			
package cn.netkiller.student.fragment.library;

import android.os.Bundle;
import android.view.LayoutInflater;
import android.view.View;
import android.view.ViewGroup;

import androidx.annotation.NonNull;
import androidx.annotation.Nullable;
import androidx.fragment.app.Fragment;
import androidx.viewpager2.adapter.FragmentStateAdapter;

import com.google.gson.Gson;

import java.util.List;

import cn.netkiller.student.cloud.PictureBook;
import cn.netkiller.student.databinding.FragmentLibraryFullscreenBinding;

public class LibraryFullscreenFragment extends Fragment {
    private static final String TAG = LibraryFullscreenFragment.class.getSimpleName();
    private final Gson gson = new Gson();
    private FragmentLibraryFullscreenBinding binding;
    private List&lt;PictureBook.DataResponse.Data&gt; categories;

    @Nullable
    @Override
    public View onCreateView(@NonNull LayoutInflater inflater,
                             @Nullable ViewGroup container,
                             @Nullable Bundle savedInstanceState) {

        binding = FragmentLibraryFullscreenBinding.inflate(inflater, container, false);
        return binding.getRoot();

    }

    @Override
    public void onViewCreated(@NonNull View view, @Nullable Bundle savedInstanceState) {
        super.onViewCreated(view, savedInstanceState);

        PictureBook pictureBook = new PictureBook();
        pictureBook.category(datas -&gt; {
            categories = datas;
            requireActivity().runOnUiThread(() -&gt; {
                categories.forEach(item -&gt; {
                    var tab = binding.tabLayout.newTab();
                    tab.setText(item.name);
                    binding.tabLayout.addTab(tab);
                });
                binding.viewPager2.setAdapter(new ViewPagerFragmentStateAdapter(this));
            });
        });

    }

    public class ViewPagerFragmentStateAdapter extends FragmentStateAdapter {


        public ViewPagerFragmentStateAdapter(@NonNull Fragment fragment) {
            super(fragment);
        }

        @NonNull
        @Override
        public Fragment createFragment(int position) {
            int id = categories.get(position).id;
            return BookshelfFragment.newInstance(id);
        }

        @Override
        public int getItemCount() {
            return categories.size();
        }
    }

    @Override
    public void onResume() {
        super.onResume();

    }

    @Override
    public void onPause() {
        super.onPause();

    }

    @Override
    public void onDestroy() {
        super.onDestroy();
    }

    @Override
    public void onDestroyView() {
        super.onDestroyView();
        binding = null;
    }
}	
			
			</pre>
			<pre class="programlisting">
			
package cn.netkiller.student.fragment.library;

import android.os.Bundle;
import android.util.Log;
import android.view.LayoutInflater;
import android.view.View;
import android.view.ViewGroup;

import androidx.annotation.NonNull;
import androidx.annotation.Nullable;
import androidx.fragment.app.Fragment;

import cn.netkiller.student.databinding.FragmentBookshelfBinding;

public class BookshelfFragment extends Fragment {
    private static final String TAG = BookshelfFragment.class.getSimpleName();
    private FragmentBookshelfBinding binding;
    private int categoryId;

    public static BookshelfFragment newInstance(int categoryId) {
        BookshelfFragment fragment = new BookshelfFragment();
        Bundle args = new Bundle();
        args.putInt("categoryId", categoryId);
//        args.putString(ARG_PARAM2, param2);
        fragment.setArguments(args);

        return fragment;
    }

    @Nullable
    @Override
    public View onCreateView(@NonNull LayoutInflater inflater,
                             @Nullable ViewGroup container,
                             @Nullable Bundle savedInstanceState) {

        binding = FragmentBookshelfBinding.inflate(inflater, container, false);

        if (getArguments() != null) {
            categoryId = getArguments().getInt("categoryId");
        }
        return binding.getRoot();
    }

    @Override
    public void onViewCreated(@NonNull View view, @Nullable Bundle savedInstanceState) {
        super.onViewCreated(view, savedInstanceState);

        Log.d(TAG, "Categroy Id: " + categoryId);
        binding.fullscreenContent.setText(categoryId + "");
    }

    @Override
    public void onResume() {
        super.onResume();
    }

    @Override
    public void onPause() {
        super.onPause();
    }

    @Override
    public void onDestroy() {
        super.onDestroy();
    }

    @Override
    public void onDestroyView() {
        super.onDestroyView();
        binding = null;
    }
}	
			
			</pre>
		</div>
		<div class="section"><div class="titlepage"><div><div><h4 class="title"><a id="id1872"></a>113.8.6.2. TabLayout + ViewPager2 + Fragments</h4></div></div></div>
			
			<pre class="programlisting">
			
    @Override
    public void onViewCreated(@NonNull View view, @Nullable Bundle savedInstanceState) {
        super.onViewCreated(view, savedInstanceState);

        PictureBook pictureBook = new PictureBook();
        pictureBook.category(datas -&gt; {
            categories = datas;
            requireActivity().runOnUiThread(() -&gt; {
                categories.forEach(item -&gt; {
                    var tab = binding.tabLayout.newTab();
                    tab.setText(item.name);
                    binding.tabLayout.addTab(tab);
                });
                binding.viewPager2.setAdapter(new ViewPagerFragmentStateAdapter(this));
                new TabLayoutMediator(binding.tabLayout, binding.viewPager2, new TabLayoutMediator.TabConfigurationStrategy() {
                    @Override
                    public void onConfigureTab(@NonNull TabLayout.Tab tab, int position) {
                        tab.setText(categories.get(position).name);
                    }
                }).attach();

            });
        });

    }
			
			</pre>
		</div>
	</div>
</div><script xmlns="" type="text/javascript" id="clustrmaps" src="//cdn.clustrmaps.com/map_v2.js?u=r5HG&amp;d=9mi5r_kkDC8uxG8HuY3p4-2qgeeVypAK9vMD-2P6BYM"></script><div class="navfooter"><hr /><table width="100%" summary="Navigation footer"><tr><td width="40%" align="left"><a accesskey="p" href="ch113s07.html">上一页</a> </td><td width="20%" align="center"><a accesskey="u" href="index.html">上一级</a></td><td width="40%" align="right"> <a accesskey="n" href="android.display.html">下一页</a></td></tr><tr><td width="40%" align="left" valign="top">113.7. Widgets </td><td width="20%" align="center"><a accesskey="h" href="../../index.html">起始页</a></td><td width="40%" align="right" valign="top"> 113.9. 屏幕</td></tr></table></div><script xmlns="">
			(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
		(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
		m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
		})(window,document,'script','//www.google-analytics.com/analytics.js','ga');

			ga('create', 'UA-11694057-1', 'auto');
			ga('send', 'pageview');

		</script><script xmlns="" async="async">
			var _hmt = _hmt || [];
			(function() {
			var hm = document.createElement("script");
			hm.src = "https://hm.baidu.com/hm.js?93967759a51cda79e49bf4e34d0b0f2c";
			var s = document.getElementsByTagName("script")[0];
			s.parentNode.insertBefore(hm, s);
			})();
</script><script xmlns="" async="async">
			(function(){
			var bp = document.createElement('script');
			var curProtocol = window.location.protocol.split(':')[0];
			if (curProtocol === 'https') {
			bp.src = 'https://zz.bdstatic.com/linksubmit/push.js';
			}
			else {
			bp.src = 'http://push.zhanzhang.baidu.com/push.js';
			}
			var s = document.getElementsByTagName("script")[0];
			s.parentNode.insertBefore(bp, s);
			})();
</script></body></html>