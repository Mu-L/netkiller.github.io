<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8" /><title>第 11 章 Switch</title><link rel="stylesheet" type="text/css" href="../docbook.css" /><meta name="generator" content="DocBook XSL Stylesheets Vsnapshot" /><meta name="keywords" content="Cisco, H3C, Juniper, F5 BIG-IP, Array, Dell, IBM, HP, , " /><link rel="home" href="../index.html" title="Netkiller Network 手札" /><link rel="up" href="index.html" title="部分 II. Cisco IOS" /><link rel="prev" href="route.reload.html" title="10.13. reload" /><link rel="next" href="switch.interface.html" title="11.2. interface" /></head><body><a xmlns="" href="//www.netkiller.cn/">Home</a> |
		<a xmlns="" href="//netkiller.github.io/">简体中文</a> |
	    <a xmlns="" href="http://netkiller.sourceforge.net/">繁体中文</a> |
	    <a xmlns="" href="/journal/index.html">杂文</a> |
	    <a xmlns="" href="https://zhuanlan.zhihu.com/netkiller">知乎专栏</a> |
   	    <a xmlns="" href="https://edu.51cto.com/lecturer/1703915.html">51CTO学院</a> |
	    <a xmlns="" href="https://edu.csdn.net/lecturer/6423">CSDN程序员研修院</a> |
	    <a xmlns="" href="https://github.com/netkiller">Github</a> |
	    <a xmlns="" href="http://my.oschina.net/neochen/">OSChina 博客</a> |
	    <a xmlns="" href="https://cloud.tencent.com/developer/column/2078">腾讯云社区</a> |
	    <a xmlns="" href="https://yq.aliyun.com/u/netkiller/">阿里云栖社区</a> |
	    <a xmlns="" href="https://www.facebook.com/bg7nyt">Facebook</a> |
	    <a xmlns="" href="http://cn.linkedin.com/in/netkiller/">Linkedin</a> |
	    <a xmlns="" href="https://www.youtube.com/user/bg7nyt/videos">Youtube</a> |
	    <a xmlns="" href="//www.netkiller.cn/home/donations.html">打赏(Donations)</a> |
	    <a xmlns="" href="//www.netkiller.cn/home/about.html">About</a><div class="navheader"><table width="100%" summary="Navigation header"><tr><th colspan="3" align="center">第 11 章 Switch</th></tr><tr><td width="20%" align="left"><a accesskey="p" href="route.reload.html">上一页</a> </td><th width="60%" align="center">部分 II. Cisco IOS</th><td width="20%" align="right"> <a accesskey="n" href="switch.interface.html">下一页</a></td></tr></table><hr /></div><table xmlns=""><tr><td><iframe src="//ghbtns.com/github-btn.html?user=netkiller&amp;repo=netkiller.github.io&amp;type=watch&amp;count=true&amp;size=large" height="30" width="170" frameborder="0" scrolling="0" style="width:170px; height: 30px;" allowTransparency="true"></iframe></td><td><iframe src="//ghbtns.com/github-btn.html?user=netkiller&amp;repo=netkiller.github.io&amp;type=fork&amp;count=true&amp;size=large" height="30" width="170" frameborder="0" scrolling="0" style="width:170px; height: 30px;" allowTransparency="true"></iframe></td><td><iframe src="//ghbtns.com/github-btn.html?user=netkiller&amp;type=follow&amp;count=true&amp;size=large" height="30" width="240" frameborder="0" scrolling="0" style="width:240px; height: 30px;" allowTransparency="true"></iframe></td><td></td><td><a href="https://zhuanlan.zhihu.com/netkiller"><img src="/images/logo/zhihu-card-default.svg" height="25" /></a></td><td valign="middle"><a href="https://zhuanlan.zhihu.com/netkiller">知乎专栏</a> ｜ <a href="https://www.zhihu.com/club/1241768772601950208">多维度架构</a></td><td></td><td></td><td></td><td></td></tr></table><div class="chapter"><div class="titlepage"><div><div><h2 class="title"><a id="switch"></a>第 11 章 Switch</h2></div></div></div><div class="toc"><p><strong>目录</strong></p><dl class="toc"><dt><span class="section"><a href="switch.html#switch.started">11.1. 交换机初始化</a></span></dt><dd><dl><dt><span class="section"><a href="switch.html#idm99694386944">11.1.1. 密码设置</a></span></dt><dt><span class="section"><a href="switch.html#idm99694385504">11.1.2. 域名，网管</a></span></dt><dt><span class="section"><a href="switch.html#switch.telnet">11.1.3. Telnet</a></span></dt><dd><dl><dt><span class="section"><a href="switch.html#idm99694383136">11.1.3.1. privilege level</a></span></dt></dl></dd><dt><span class="section"><a href="switch.html#idm99694382352">11.1.4. 保存当前配置</a></span></dt><dt><span class="section"><a href="switch.html#idm99694381456">11.1.5. 恢复交换机出厂值</a></span></dt></dl></dd><dt><span class="section"><a href="switch.interface.html">11.2. interface</a></span></dt><dd><dl><dt><span class="section"><a href="switch.interface.html#idm99694380208">11.2.1. show interfaces status</a></span></dt><dt><span class="section"><a href="switch.interface.html#idm99694379568">11.2.2. ip address</a></span></dt><dt><span class="section"><a href="switch.interface.html#idm99694378160">11.2.3. 配置端口速率及双工模式</a></span></dt><dt><span class="section"><a href="switch.interface.html#idm99694376464">11.2.4. range</a></span></dt><dt><span class="section"><a href="switch.interface.html#idm99694373536">11.2.5. 端口隔离</a></span></dt></dl></dd><dt><span class="section"><a href="switch.dhcp.html">11.3. DHCP</a></span></dt><dd><dl><dt><span class="section"><a href="switch.dhcp.html#switch.gateway">11.3.1. Gateway</a></span></dt><dt><span class="section"><a href="switch.dhcp.html#switch.dhcp.snooping">11.3.2. snooping</a></span></dt><dt><span class="section"><a href="switch.dhcp.html#idm99591927168">11.3.3. DHCP中继代理</a></span></dt></dl></dd><dt><span class="section"><a href="switch.switchport.html">11.4. Route port</a></span></dt><dt><span class="section"><a href="switch.monitor.html">11.5. 交换机端口镜像配置</a></span></dt><dt><span class="section"><a href="switch.channel-group.html">11.6. Ethernet Port Groups</a></span></dt><dd><dl><dt><span class="section"><a href="switch.channel-group.html#idm99591920192">11.6.1. LACP</a></span></dt><dt><span class="section"><a href="switch.channel-group.html#idm99591918928">11.6.2. desirable</a></span></dt></dl></dd><dt><span class="section"><a href="switch.vlan.html">11.7. VLAN</a></span></dt><dd><dl><dt><span class="section"><a href="switch.vlan.html#idm99591915888">11.7.1. vlan database</a></span></dt><dt><span class="section"><a href="switch.vlan.html#idm99591915248">11.7.2. 两层Switch配置讲解</a></span></dt><dt><span class="section"><a href="switch.vlan.html#idm99591911776">11.7.3. 3 Layer Switch</a></span></dt><dt><span class="section"><a href="switch.vlan.html#switch.vtp">11.7.4. VTP</a></span></dt><dd><dl><dt><span class="section"><a href="switch.vlan.html#idm99591900816">11.7.4.1. Configuring a VTP Server</a></span></dt><dt><span class="section"><a href="switch.vlan.html#idm99591899232">11.7.4.2. Configuring a VTP Client</a></span></dt><dt><span class="section"><a href="switch.vlan.html#idm99591898336">11.7.4.3. example for vtp</a></span></dt></dl></dd></dl></dd><dt><span class="section"><a href="switch.acl.html">11.8. ACL</a></span></dt><dt><span class="section"><a href="switch.speed.html">11.9. 流量控制</a></span></dt><dd><dl><dt><span class="section"><a href="switch.speed.html#idm99591892176">11.9.1. 粗糙的流量限制</a></span></dt><dt><span class="section"><a href="switch.speed.html#idm99591891232">11.9.2. bandwidth</a></span></dt><dt><span class="section"><a href="switch.speed.html#idm99591890432">11.9.3. priority</a></span></dt></dl></dd><dt><span class="section"><a href="stack-manager.html">11.10. stack-manager</a></span></dt><dt><span class="section"><a href="switch.hsrp.html">11.11. HSRP(Hot Standby Router Protocol)</a></span></dt><dt><span class="section"><a href="cdp.html">11.12. CDP (Cisco Discovery Protocol)</a></span></dt><dd><dl><dt><span class="section"><a href="cdp.html#idm99591882160">11.12.1. clear cdp counters</a></span></dt><dt><span class="section"><a href="cdp.html#idm99591881360">11.12.2. show cdp</a></span></dt><dt><span class="section"><a href="cdp.html#idm99591880512">11.12.3. show cdp entry</a></span></dt><dt><span class="section"><a href="cdp.html#idm99591879856">11.12.4. show cdp interface</a></span></dt><dt><span class="section"><a href="cdp.html#idm99591879184">11.12.5. show cdp neighbors</a></span></dt></dl></dd><dt><span class="section"><a href="switch.4507.html">11.13. 4506/4507 专有命令</a></span></dt><dd><dl><dt><span class="section"><a href="switch.4507.html#switch.auth">11.13.1. 用户认证</a></span></dt><dt><span class="section"><a href="switch.4507.html#switch.poe">11.13.2. PoE</a></span></dt><dt><span class="section"><a href="switch.4507.html#switch.module">11.13.3. show module</a></span></dt></dl></dd><dt><span class="section"><a href="switch.example.html">11.14. Switch Config Example</a></span></dt><dd><dl><dt><span class="section"><a href="switch.example.html#vlan.routing">11.14.1. VLan Router</a></span></dt><dd><dl><dt><span class="section"><a href="switch.example.html#idm99591870944">11.14.1.1. VLAN间DHCP</a></span></dt><dt><span class="section"><a href="switch.example.html#vlan.dhcp.routing">11.14.1.2. 多vlan与vlan间路由，并且每个vlan配合一个DHCP池，所有vlan均能访问internet</a></span></dt></dl></dd><dt><span class="section"><a href="switch.example.html#faq.switch.vlan">11.14.2. VLAN下联Switch</a></span></dt><dt><span class="section"><a href="switch.example.html#faq.lan2lan">11.14.3. LAN to LAN</a></span></dt><dt><span class="section"><a href="switch.example.html#2811-2960">11.14.4. Cisco 2811 Router + 2960 Switch</a></span></dt><dd><dl><dt><span class="section"><a href="switch.example.html#idm99591857056">11.14.4.1. running-config</a></span></dt></dl></dd><dt><span class="section"><a href="switch.example.html#faq.3750">11.14.5. Cisco Catalyst 3750 series DHCP + VLAN + Routing Example</a></span></dt><dt><span class="section"><a href="switch.example.html#3750-2960">11.14.6. Cisco Catalyst 3750 + Cisco Catalyst 2960 VTP Example</a></span></dt><dd><dl><dt><span class="section"><a href="switch.example.html#idm99591844384">11.14.6.1. VTP Server</a></span></dt><dt><span class="section"><a href="switch.example.html#idm99591842800">11.14.6.2. VTP Client</a></span></dt><dt><span class="section"><a href="switch.example.html#idm99591841760">11.14.6.3. Cisco Config File</a></span></dt></dl></dd></dl></dd></dl></div><p>Cisco 固定配置交换机命名规则</p><pre class="screen">
对于Cisco的固定配置的交换机，一般有3750，3550，3560，2960，2970这几个系列。

它们在型号命令上有自己相应的规则，特总结如下：

eg: WS-C3750G-48TS-S

C3750表明这款产品属于3750这个系列，也就是产品的型号。

G----表明其所有接口都是支持千兆或以上，如果没有这个就表明其主要端口都是10/100M的或者100M的

48----表明其拥有主要的端口数量为48个

T----表明其主要端口是电口（也就是所谓的Twirst Pair的端口

P----表明其主要端口是电口，同时支持PoE以太网供电

S----表明其带的扩展的接口为SFP类型的接口

最后部分的-S表明交换机带的软件是SMI标准影像的,-E表明是EMI影像的
	</pre><div class="section"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a id="switch.started"></a>11.1. 交换机初始化</h2></div></div></div><p>Cisco Catalyst 2960 Series Switches</p><pre class="screen">
		
Press RETURN to get started!


*Mar  1 00:00:25.073: %LINEPROTO-5-UPDOWN: Line protocol on Interface Vlan1, cha                                                                                                 nged state to down
*Mar  1 00:00:26.189: %SPANTREE-5-EXTENDED_SYSID: Extended SysId enabled for typ                                                                                                 e vlan
*Mar  1 00:00:47.102: %SYS-5-RESTART: System restarted --
Cisco IOS Software, C2960 Software (C2960-LANBASEK9-M), Version 12.2(44)SE6, REL                                                                                                 EASE SOFTWARE (fc1)
Copyright (c) 1986-2009 by Cisco Systems, Inc.
Compiled Mon 09-Mar-09 18:10 by gereddy


         --- System Configuration Dialog ---

Would you like to enter the initial configuration dialog? [yes/no]:
Would you like to enter the initial configuration dialog? [yes/no]: yes

At any point you may enter a question mark '?' for help.
Use ctrl-c to abort configuration dialog at any prompt.
Default settings are in square brackets '[]'.


Basic management setup configures only enough connectivity
for management of the system, extended setup will ask you
to configure each interface on the system

Would you like to enter basic management setup? [yes/no]: yes
Configuring global parameters:

  Enter host name [Switch]:

  The enable secret is a password used to protect access to
  privileged EXEC and configuration modes. This password, after
  entered, becomes encrypted in the configuration.
  Enter enable secret: chen

  The enable password is used when you do not specify an
  enable secret password, with some older software versions, and
  some boot images.
  Enter enable password: chen
% Please choose a password that is different from the enable secret
  Enter enable password: chen

  The virtual terminal password is used to protect
  access to the router over a network interface.
  Enter virtual terminal password: chen
  Configure SNMP Network Management? [no]: yes
    Community string [public]:

Current interface summary

Interface              IP-Address      OK? Method Status                Protocol
Vlan1                  unassigned      YES unset  up                    down
FastEthernet0/1        unassigned      YES unset  down                  down
FastEthernet0/2        unassigned      YES unset  down                  down
FastEthernet0/3        unassigned      YES unset  down                  down
FastEthernet0/4        unassigned      YES unset  down                  down
FastEthernet0/5        unassigned      YES unset  down                  down
FastEthernet0/6        unassigned      YES unset  down                  down
FastEthernet0/7        unassigned      YES unset  down                  down
FastEthernet0/8        unassigned      YES unset  down                  down
FastEthernet0/9        unassigned      YES unset  down                  down
FastEthernet0/10       unassigned      YES unset  down                  down
FastEthernet0/11       unassigned      YES unset  down                  down
FastEthernet0/12       unassigned      YES unset  down                  down
FastEthernet0/13       unassigned      YES unset  down                  down
FastEthernet0/14       unassigned      YES unset  down                  down
FastEthernet0/15       unassigned      YES unset  down                  down
FastEthernet0/16       unassigned      YES unset  down                  down
FastEthernet0/17       unassigned      YES unset  down                  down
FastEthernet0/18       unassigned      YES unset  down                  down
FastEthernet0/19       unassigned      YES unset  down                  down
FastEthernet0/20       unassigned      YES unset  down                  down
FastEthernet0/21       unassigned      YES unset  down                  down
FastEthernet0/22       unassigned      YES unset  down                  down
FastEthernet0/23       unassigned      YES unset  down                  down
FastEthernet0/24       unassigned      YES unset  down                  down
GigabitEthernet0/1     unassigned      YES unset  down                  down
GigabitEthernet0/2     unassigned      YES unset  down                  down

Enter interface name used to connect to the
management network from the above interface summary: FastEthernet0/24

Configuring interface FastEthernet0/24:
  Configure IP on this interface? [no]: yes
    IP address for this interface: 172.16.0.253
    Subnet mask for this interface [255.255.0.0] :
    Class B network is 172.16.0.0, 16 subnet bits; mask is /16
Would you like to enable as a cluster command switch? [yes/no]: yes
Enter cluster name: cl1

The following configuration command script was created:

hostname Switch
enable secret 5 $1$W1RW$ZdWR.sS/g2RwJMv4F5sRq0
enable password chen
line vty 0 15
password chen
snmp-server community public
!
!
interface Vlan1
shutdown
no ip address
!
interface FastEthernet0/1
!
interface FastEthernet0/2
!
interface FastEthernet0/3
!
interface FastEthernet0/4
!
 --More--

		
		</pre><div class="section"><div class="titlepage"><div><div><h3 class="title"><a id="idm99694386944"></a>11.1.1. 密码设置</h3></div></div></div><p>基本操作</p><pre class="screen">
Switch command
Switch &gt; en 进入特权模式
Switch # conf t 进入全局配置模式
Switch（config）# interface interface-num 进入接口
Switch（config）# hostname name 给交换机命名
Switch（config）# enable password password 设置明文密码
Switch（config）# enable secret password 设置加密的启用秘密口令。如果设置则取代明文口令
Switch # copy running-config startup-config
Switch # write 保存设置
			</pre></div><div class="section"><div class="titlepage"><div><div><h3 class="title"><a id="idm99694385504"></a>11.1.2. 域名，网管</h3></div></div></div><p>初始化设置</p><pre class="screen">
Switch setup
switch（config）# ip default-gateway ip-address
switch（config）# ip domain-name domain-name
switch（config）# ip name-server IP-address 交换机上设置远程访问,用于交换机管理
			</pre></div><div class="section"><div class="titlepage"><div><div><h3 class="title"><a id="switch.telnet"></a>11.1.3. Telnet</h3></div></div></div><p>通过Telnet进入命令行接口</p><pre class="screen">
Switch&gt;enable
Switch#conf t
Switch(config)#line vty 0 4
Switch(config－line)#login
Switch(config－line)#password cisco
			</pre><div class="section"><div class="titlepage"><div><div><h4 class="title"><a id="idm99694383136"></a>11.1.3.1. privilege level</h4></div></div></div><pre class="screen">
line vty 5 15
 privilege level 15
 password neo
 login
!
				</pre></div></div><div class="section"><div class="titlepage"><div><div><h3 class="title"><a id="idm99694382352"></a>11.1.4. 保存当前配置</h3></div></div></div><p>Save</p><pre class="screen">
Switch#wr
Building configuration...
[OK]
			</pre></div><div class="section"><div class="titlepage"><div><div><h3 class="title"><a id="idm99694381456"></a>11.1.5. 恢复交换机出厂值</h3></div></div></div><pre class="screen">
Switch# erase startup-config
			</pre></div></div></div><div xmlns="" id="SOHUCS"></div><script xmlns="" charset="utf-8" type="text/javascript" src="https://cy-cdn.kuaizhan.com/upload/changyan.js"></script><script xmlns="" type="text/javascript">
window.changyan.api.config({
appid: 'cyvwjQUG3',
conf: 'prod_ef966242df3d8b5acb1e0ee9fc01cafe'
});
</script><script xmlns="" type="text/javascript" id="clustrmaps" src="//cdn.clustrmaps.com/map_v2.js?u=r5HG&amp;d=9mi5r_kkDC8uxG8HuY3p4-2qgeeVypAK9vMD-2P6BYM"></script><div class="navfooter"><hr /><table width="100%" summary="Navigation footer"><tr><td width="40%" align="left"><a accesskey="p" href="route.reload.html">上一页</a> </td><td width="20%" align="center"><a accesskey="u" href="index.html">上一级</a></td><td width="40%" align="right"> <a accesskey="n" href="switch.interface.html">下一页</a></td></tr><tr><td width="40%" align="left" valign="top">10.13. reload </td><td width="20%" align="center"><a accesskey="h" href="../index.html">起始页</a></td><td width="40%" align="right" valign="top"> 11.2. interface</td></tr></table></div><script xmlns="">
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

  ga('create', 'UA-11694057-1', 'auto');
  ga('send', 'pageview');

</script><script xmlns="" async="async">
var _hmt = _hmt || [];
(function() {
  var hm = document.createElement("script");
  hm.src = "https://hm.baidu.com/hm.js?93967759a51cda79e49bf4e34d0b0f2c";
  var s = document.getElementsByTagName("script")[0]; 
  s.parentNode.insertBefore(hm, s);
})();
</script><script xmlns="" async="async">
(function(){
    var bp = document.createElement('script');
    var curProtocol = window.location.protocol.split(':')[0];
    if (curProtocol === 'https') {
        bp.src = 'https://zz.bdstatic.com/linksubmit/push.js';        
    }
    else {
        bp.src = 'http://push.zhanzhang.baidu.com/push.js';
    }
    var s = document.getElementsByTagName("script")[0];
    s.parentNode.insertBefore(bp, s);
})();
</script></body></html>