<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8" /><title>第 19 章 MySQL Server</title><link rel="stylesheet" type="text/css" href="../../docbook.css" /><meta name="generator" content="DocBook XSL Stylesheets Vsnapshot" /><meta name="keywords" content="MySQL, PostgreSQL, Oracle, NoSQL, ER, TokyoCabinet/Tyrant, Memcache, Membase, Redis, Flare, Voldemort, LevelDB, MongoDB, GreenSQL, RDBMS, ORDBMS" /><link rel="home" href="../../index.html" title="Netkiller Database 手札" /><link rel="up" href="../index.html" title="部分 III. MySQL" /><link rel="prev" href="../index.html" title="部分 III. MySQL" /><link rel="next" href="plugin.html" title="19.2. MySQL Plugin" /></head><body><a xmlns="" href="//www.netkiller.cn/">Home</a> |
		<a xmlns="" href="//netkiller.github.io/">简体中文</a> |
	    <a xmlns="" href="http://netkiller.sourceforge.net/">繁体中文</a> |
	    <a xmlns="" href="/journal/index.html">杂文</a> |
	    <a xmlns="" href="https://github.com/netkiller">Github</a> |
	    <a xmlns="" href="https://zhuanlan.zhihu.com/netkiller">知乎专栏</a> |
   	    <a xmlns="" href="https://edu.51cto.com/lecturer/1703915.html">51CTO学院</a> |
	    <a xmlns="" href="https://edu.csdn.net/lecturer/6423">CSDN程序员研修院</a> |
	    <a xmlns="" href="http://my.oschina.net/neochen/">OSChina 博客</a> |
	    <a xmlns="" href="https://cloud.tencent.com/developer/column/2078">腾讯云社区</a> |
	    <a xmlns="" href="https://yq.aliyun.com/u/netkiller/">阿里云栖社区</a> |
	    <a xmlns="" href="https://www.facebook.com/bg7nyt">Facebook</a> |
	    <a xmlns="" href="http://cn.linkedin.com/in/netkiller/">Linkedin</a> |
	    <a xmlns="" href="https://www.youtube.com/user/bg7nyt/videos">Youtube</a> |
	    <a xmlns="" href="//www.netkiller.cn/home/donations.html">打赏(Donations)</a> |
	    <a xmlns="" href="//www.netkiller.cn/home/about.html">About</a><div class="navheader"><table width="100%" summary="Navigation header"><tr><th colspan="3" align="center">第 19 章 MySQL Server</th></tr><tr><td width="20%" align="left"><a accesskey="p" href="../index.html">上一页</a> </td><th width="60%" align="center">部分 III. MySQL</th><td width="20%" align="right"> <a accesskey="n" href="plugin.html">下一页</a></td></tr></table><hr /></div><table xmlns=""><tr><td><iframe src="//ghbtns.com/github-btn.html?user=netkiller&amp;repo=netkiller.github.io&amp;type=watch&amp;count=true&amp;size=large" height="30" width="170" frameborder="0" scrolling="0" style="width:170px; height: 30px;" allowTransparency="true"></iframe></td><td><iframe src="//ghbtns.com/github-btn.html?user=netkiller&amp;repo=netkiller.github.io&amp;type=fork&amp;count=true&amp;size=large" height="30" width="170" frameborder="0" scrolling="0" style="width:170px; height: 30px;" allowTransparency="true"></iframe></td><td><iframe src="//ghbtns.com/github-btn.html?user=netkiller&amp;type=follow&amp;count=true&amp;size=large" height="30" width="240" frameborder="0" scrolling="0" style="width:240px; height: 30px;" allowTransparency="true"></iframe></td><td></td><td><a href="https://zhuanlan.zhihu.com/netkiller"><img src="/images/logo/zhihu-card-default.svg" height="25" /></a></td><td valign="middle"><a href="https://zhuanlan.zhihu.com/netkiller">知乎专栏</a> ｜ <a href="https://www.zhihu.com/club/1241768772601950208">多维度架构</a></td><td></td><td></td><td></td><td></td></tr></table><div class="chapter"><div class="titlepage"><div><div><h2 class="title"><a id="index"></a>第 19 章 MySQL Server</h2></div></div></div><div class="toc"><p><strong>目录</strong></p><dl class="toc"><dt><span class="section"><a href="index.html#mysql.install">19.1. MySQL 安装</a></span></dt><dd><dl><dt><span class="section"><a href="index.html#idm219672006048">19.1.1. Rocky Linux 9.0</a></span></dt><dt><span class="section"><a href="index.html#mysql.centos">19.1.2. CentOS</a></span></dt><dt><span class="section"><a href="index.html#mysql.docker">19.1.3. Docker</a></span></dt><dt><span class="section"><a href="index.html#mysql.ubuntu">19.1.4. Ubuntu/Debian</a></span></dt><dt><span class="section"><a href="index.html#mysql.source">19.1.5. 源码安装</a></span></dt><dt><span class="section"><a href="index.html#mysql.binary">19.1.6. 二进制版本</a></span></dt><dt><span class="section"><a href="index.html#mysql.yum">19.1.7. Installing MySQL on Linux Using the MySQL Yum Repository</a></span></dt><dt><span class="section"><a href="index.html#firewall">19.1.8. Firewall</a></span></dt><dt><span class="section"><a href="index.html#mac">19.1.9. Mac OS</a></span></dt><dt><span class="section"><a href="index.html#mariadb">19.1.10. MariaDB</a></span></dt><dt><span class="section"><a href="index.html#percona">19.1.11. Percona</a></span></dt></dl></dd><dt><span class="section"><a href="plugin.html">19.2. MySQL Plugin</a></span></dt><dd><dl><dt><span class="section"><a href="plugin.html#idm219671935552">19.2.1. validate_password</a></span></dt><dt><span class="section"><a href="plugin.html#netkiller.mysql.images">19.2.2. MySQL Images manager</a></span></dt><dt><span class="section"><a href="plugin.html#netkiller.mysql.fifo">19.2.3. MySQL fifo</a></span></dt><dt><span class="section"><a href="plugin.html#netkiller.mysql.out2file">19.2.4. 内容输出到文本插件</a></span></dt></dl></dd><dt><span class="section"><a href="replication.html">19.3. Replication</a></span></dt><dd><dl><dt><span class="section"><a href="replication.html#master.slave">19.3.1. Master Slave</a></span></dt><dt><span class="section"><a href="replication.html#master.master">19.3.2. Master Master(主主)</a></span></dt><dt><span class="section"><a href="replication.html#semisynchronous">19.3.3. Semisynchronous Replication</a></span></dt><dt><span class="section"><a href="replication.html#multi-master">19.3.4. multi-master replication</a></span></dt><dt><span class="section"><a href="replication.html#multi-source">19.3.5. multi-source replication</a></span></dt><dt><span class="section"><a href="replication.html#replication.error">19.3.6. 与复制有关的问题</a></span></dt><dt><span class="section"><a href="replication.html#GTID">19.3.7. GTID</a></span></dt></dl></dd><dt><span class="section"><a href="cluster.html">19.4. MySQL Custer</a></span></dt><dd><dl><dt><span class="section"><a href="cluster.html#cluster.mgm">19.4.1. Management node (MGM node)</a></span></dt><dt><span class="section"><a href="cluster.html#cluster.data">19.4.2. Data node</a></span></dt><dt><span class="section"><a href="cluster.html#cluster.sql">19.4.3. SQL node</a></span></dt><dt><span class="section"><a href="cluster.html#cluster.start">19.4.4. Starting</a></span></dt><dt><span class="section"><a href="cluster.html#cluster.shut">19.4.5. Shutdown</a></span></dt><dt><span class="section"><a href="cluster.html#cluster.testing">19.4.6. Testing</a></span></dt></dl></dd><dt><span class="section"><a href="mysql-proxy.html">19.5. MySQL Proxy</a></span></dt><dd><dl><dt><span class="section"><a href="mysql-proxy.html#idm219671039712">19.5.1. Ubuntu</a></span></dt><dt><span class="section"><a href="mysql-proxy.html#idm219671039584">19.5.2. CentOS</a></span></dt></dl></dd><dt><span class="section"><a href="router.html">19.6. MySQL Router</a></span></dt><dd><dl><dt><span class="section"><a href="router.html#idm219671028048">19.6.1. 安装 MySQL Router</a></span></dt><dt><span class="section"><a href="router.html#idm219671026048">19.6.2. 配置 MySQL Router</a></span></dt><dt><span class="section"><a href="router.html#idm219671022672">19.6.3. MySQL Router ， Haproxy，LVS 的选择</a></span></dt></dl></dd><dt><span class="section"><a href="my.cnf.html">19.7. my.cnf</a></span></dt><dd><dl><dt><span class="section"><a href="my.cnf.html#my.cnf.bind-address">19.7.1. bind-address</a></span></dt><dt><span class="section"><a href="my.cnf.html#idm219671018160">19.7.2. 禁用TCP/IP链接</a></span></dt><dt><span class="section"><a href="my.cnf.html#idm219671017088">19.7.3. 配置字符集</a></span></dt><dt><span class="section"><a href="my.cnf.html#idm219671012448">19.7.4. 最大链接数 max_connections</a></span></dt><dt><span class="section"><a href="my.cnf.html#idm219671011728">19.7.5. 默认引擎 storage-engine</a></span></dt><dt><span class="section"><a href="my.cnf.html#idm219671011008">19.7.6. max_allowed_packet</a></span></dt><dt><span class="section"><a href="my.cnf.html#idm219671010304">19.7.7. skip-name-resolve</a></span></dt><dt><span class="section"><a href="my.cnf.html#idm219671008240">19.7.8. timeout</a></span></dt><dt><span class="section"><a href="my.cnf.html#replication">19.7.9. 与复制有关的参数</a></span></dt><dt><span class="section"><a href="my.cnf.html#idm219671001024">19.7.10. 与 InnoDB 有关的配置项</a></span></dt><dt><span class="section"><a href="my.cnf.html#idm219670998912">19.7.11. EVENT 设置</a></span></dt><dt><span class="section"><a href="my.cnf.html#idm219670997936">19.7.12. 日志</a></span></dt><dt><span class="section"><a href="my.cnf.html#idm219670995792">19.7.13. MySQL 5.7 my.cnf 实例</a></span></dt><dt><span class="section"><a href="my.cnf.html#idm219670993360">19.7.14. Example for my.cnf</a></span></dt></dl></dd><dt><span class="section"><a href="variables.html">19.8. variables</a></span></dt><dd><dl><dt><span class="section"><a href="variables.html#idm219670991360">19.8.1. 查询多个变量</a></span></dt><dt><span class="section"><a href="variables.html#time_zone">19.8.2. time_zone</a></span></dt><dt><span class="section"><a href="variables.html#sql_mode">19.8.3. sql_mode</a></span></dt><dt><span class="section"><a href="variables.html#wait_timeout">19.8.4. wait_timeout</a></span></dt><dt><span class="section"><a href="variables.html#table_lock_wait_timeout">19.8.5. table_lock_wait_timeout</a></span></dt><dt><span class="section"><a href="variables.html#low_priority_updates">19.8.6. low_priority_updates</a></span></dt><dt><span class="section"><a href="variables.html#idm219783145936">19.8.7. collation_server</a></span></dt><dt><span class="section"><a href="variables.html#character_set">19.8.8. character_set</a></span></dt><dt><span class="section"><a href="variables.html#datadir">19.8.9. datadir</a></span></dt><dt><span class="section"><a href="variables.html#plugin_dir">19.8.10. plugin_dir</a></span></dt><dt><span class="section"><a href="variables.html#storage_engine">19.8.11. storage_engine</a></span></dt><dt><span class="section"><a href="variables.html#timeout">19.8.12. timeout</a></span></dt><dt><span class="section"><a href="variables.html#max_connections">19.8.13. max_connections</a></span></dt><dt><span class="section"><a href="variables.html#variables.autocommit">19.8.14. 自动提交 autocommit</a></span></dt></dl></dd><dt><span class="section"><a href="monitoring.html">19.9. Monitoring</a></span></dt><dd><dl><dt><span class="section"><a href="monitoring.html#mon.prog">19.9.1. Analysis and Optimization</a></span></dt><dt><span class="section"><a href="monitoring.html#monitoring.cacti">19.9.2. Cacti</a></span></dt><dt><span class="section"><a href="monitoring.html#mysql.snmp">19.9.3. Monitoring MySQL with SNMP</a></span></dt></dl></dd></dl></div><div class="section"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a id="mysql.install"></a>19.1. MySQL 安装</h2></div><div><h3 class="subtitle">MySQL Installation</h3></div></div></div><p>http://downloads.mysql.com/archives.php</p><div class="section"><div class="titlepage"><div><div><h3 class="title"><a id="idm219672006048"></a>19.1.1. Rocky Linux 9.0</h3></div></div></div><pre class="screen">
		
[root@netkiller ~]# dnf install -y mysql-server

[root@netkiller ~]# systemctl enable mysqld
Created symlink /etc/systemd/system/multi-user.target.wants/mysqld.service → /usr/lib/systemd/system/mysqld.service.
		
		</pre><p>备份配置文件</p><pre class="screen">
			
cp /etc/my.cnf{,.original}
cp /etc/my.cnf.d/mysql-server.cnf{,.original}
cp /etc/my.cnf.d/client.cnf{,.original}

cat &gt;&gt; /etc/my.cnf.d/mysql-server.cnf &lt;&lt;EOF

# Add by Neo
character-set-server=utf8mb4
collation-server=utf8mb4_general_ci
explicit_defaults_for_timestamp=true
lower_case_table_names=1
EOF
			
		</pre><p>设置文件打开数据</p><pre class="screen">
			
cat &gt;&gt; /etc/security/limits.d/20-nofile.conf &lt;&lt;EOF
mysql soft nofile 65535
mysql hard nofile 65535
EOF

mkdir /etc/systemd/system/mysqld.service.d/

cat &gt;&gt; /etc/systemd/system/mysqld.service.d/override.conf  &lt;&lt;EOF
[Service]
LimitNOFILE=65000
EOF
			
		</pre><p>启动数据库</p><pre class="screen">
			
[root@netkiller ~]# systemctl start mysqld
			
		</pre><p>创建用户数据库 root 用户</p><p>CREATE USER 'root'@'%' IDENTIFIED BY 'test';</p><p>GRANT ALL ON *.* TO 'root'@'%' WITH GRANT OPTION;</p><pre class="screen">
			
[root@netkiller ~]# mysql
Welcome to the MySQL monitor.  Commands end with ; or \g.
Your MySQL connection id is 10
Server version: 8.0.28 Source distribution

Copyright (c) 2000, 2022, Oracle and/or its affiliates.

Oracle is a registered trademark of Oracle Corporation and/or its
affiliates. Other names may be trademarks of their respective
owners.

Type 'help;' or '\h' for help. Type '\c' to clear the current input statement.

mysql&gt; CREATE USER 'root'@'%' IDENTIFIED BY 'chen';
Query OK, 0 rows affected (0.03 sec)

mysql&gt; GRANT ALL ON *.* TO 'root'@'%' WITH GRANT OPTION;
Query OK, 0 rows affected (0.02 sec)
			
		</pre><p>开启防火墙</p><pre class="screen">
		
[root@netkiller ~]# firewall-cmd --permanent --zone=public --add-port=3306/tcp
success		
		
		</pre></div><div class="section"><div class="titlepage"><div><div><h3 class="title"><a id="mysql.centos"></a>19.1.2. CentOS</h3></div></div></div><div class="section"><div class="titlepage"><div><div><h4 class="title"><a id="idm219671999728"></a>19.1.2.1. CentOS 8 Stream + dnf 安装 Mysql</h4></div></div></div><pre class="screen">
			
[root@localhost ~]# dnf install -y mysql-server mysql mysql-test
[root@localhost ~]# systemctl enable mysqld
Created symlink /etc/systemd/system/multi-user.target.wants/mysqld.service → /usr/lib/systemd/system/mysqld.service.	
			
			</pre><p>备份配置文件</p><pre class="screen">
			
cp /etc/my.cnf{,.original}
cp /etc/my.cnf.d/mysql-server.cnf /etc/mysql-server.cnf.original
cat &gt;&gt; /etc/my.cnf.d/mysql-server.cnf &lt;&lt;EOF

# Add by Neo
character-set-server=utf8mb4
collation-server=utf8mb4_general_ci
explicit_defaults_for_timestamp=true
lower_case_table_names=1
EOF
			
			</pre><p>设置文件打开数据</p><pre class="screen">
			
cat &gt;&gt; /etc/security/limits.d/20-nofile.conf &lt;&lt;EOF
mysql soft nofile 65535
mysql hard nofile 65535
EOF

mkdir /etc/systemd/system/mysqld.service.d/

cat &gt;&gt; /etc/systemd/system/mysqld.service.d/override.conf  &lt;&lt;EOF
[Service]
LimitNOFILE=65000
EOF
			
			</pre><p>启动数据库</p><pre class="screen">
			
[root@localhost ~]# systemctl start mysqld			
			
			</pre><p>创建用户</p><pre class="screen">
			
mysql&gt; CREATE USER 'root'@'%' IDENTIFIED BY 'test';
Query OK, 0 rows affected (0.05 sec)

mysql&gt; GRANT ALL ON *.* TO 'root'@'%' WITH GRANT OPTION;	
Query OK, 0 rows affected (0.03 sec)
			
			</pre><div class="example"><a id="idm219671995616"></a><p class="title"><strong>例 19.1. MySQL 8 创建root账号</strong></p><div class="example-contents"><pre class="screen">
				
[root@localhost ~]# mysql
Welcome to the MySQL monitor.  Commands end with ; or \g.
Your MySQL connection id is 8
Server version: 8.0.21 Source distribution

Copyright (c) 2000, 2020, Oracle and/or its affiliates. All rights reserved.

Oracle is a registered trademark of Oracle Corporation and/or its
affiliates. Other names may be trademarks of their respective
owners.

Type 'help;' or '\h' for help. Type '\c' to clear the current input statement.

mysql&gt; CREATE USER 'root'@'%' IDENTIFIED BY 'test';
Query OK, 0 rows affected (0.00 sec)

mysql&gt; GRANT ALL ON *.* TO 'root'@'%' WITH GRANT OPTION;
Query OK, 0 rows affected (0.01 sec)

mysql&gt; FLUSH PRIVILEGES;
Query OK, 0 rows affected (0.00 sec)

mysql&gt;
				
				</pre></div></div><br class="example-break" /></div><div class="section"><div class="titlepage"><div><div><h4 class="title"><a id="idm219671999600"></a>19.1.2.2. CentOS 6.2 + MySQL 5.5.25 (RPM)</h4></div></div></div><p>准备下面的软件包</p><pre class="screen">

# ls -1
MySQL-client-5.5.25-1.el6.x86_64.rpm
MySQL-devel-5.5.25-1.el6.x86_64.rpm
MySQL-server-5.5.25-1.el6.x86_64.rpm
MySQL-shared-5.5.25-1.el6.x86_64.rpm
MySQL-shared-compat-5.5.25-1.el6.x86_64.rpm
			</pre><p>使用 yum 本地安装 rpm, yum 可以帮你解决依赖于冲突 </p><pre class="screen">

# yum localinstall MySQL-*
			</pre><pre class="screen">

# /etc/init.d/mysql start
Starting MySQL... SUCCESS!

# /usr/bin/mysqladmin -u root password 'tUG26WSslP30bkbwtMhn'
			</pre></div><div class="section"><div class="titlepage"><div><div><h4 class="title"><a id="idm219671992080"></a>19.1.2.3. MySQL 8.0</h4></div></div></div><p>安装</p><pre class="screen">
			
curl -s https://raw.githubusercontent.com/oscm/shell/master/database/mysql/8.0/server.sh | bash
			
			</pre><p>启动</p><pre class="screen">
			
systemctl enable mysql
systemctl start mysql
			
			</pre><p>必须修改密码后才能使用</p><pre class="screen">
			
[root@netkiller ~]# grep "A temporary password" /var/log/mysqld.log
2018-04-03T02:24:16.935070Z 1 [Note] A temporary password is generated for root@localhost: kMA*d&lt;e#Q3EC
2018-04-20T03:36:31.935143Z 5 [Note] [MY-010454] [Server] A temporary password is generated for root@localhost: MqatK=hae5F#

[root@netkiller ~]# mysqladmin -u root -p'MqatK=hae5F#' password
mysqladmin: [Warning] Using a password on the command line interface can be insecure.
New password:
Confirm new password:
Warning: Since password will be sent to server in plain text, use ssl connection to ensure password safety.

[root@netkiller ~]# mysql -uroot -p
Enter password:
Welcome to the MySQL monitor.  Commands end with ; or \g.
Your MySQL connection id is 10
Server version: 8.0.11 MySQL Community Server - GPL

Copyright (c) 2000, 2018, Oracle and/or its affiliates. All rights reserved.

Oracle is a registered trademark of Oracle Corporation and/or its
affiliates. Other names may be trademarks of their respective
owners.

Type 'help;' or '\h' for help. Type '\c' to clear the current input statement.

mysql&gt;

			
			</pre><p>创建用户</p><pre class="screen">
			
mysql&gt; CREATE USER 'root'@'%' IDENTIFIED BY 'MQiEge1ikst7S_6tlXzBOmt_4b';
Query OK, 0 rows affected (0.05 sec)

mysql&gt; GRANT ALL ON *.* TO 'root'@'%';
Query OK, 0 rows affected (0.03 sec)
			
			</pre></div></div><div class="section"><div class="titlepage"><div><div><h3 class="title"><a id="mysql.docker"></a>19.1.3. Docker</h3></div></div></div><pre class="screen">
		
docker run --name mysql -d \
    --restart always \
    -e MYSQL_ROOT_PASSWORD=123456 \
    -e MYSQL_DATABASE=test \
    -e MYSQL_USER=test \
    -e MYSQL_PASSWORD=test \
    -p 127.0.0.1:3306:3306 \
    mysql:latest		
		
		</pre></div><div class="section"><div class="titlepage"><div><div><h3 class="title"><a id="mysql.ubuntu"></a>19.1.4. Ubuntu/Debian</h3></div><div><h4 class="subtitle">Installation by apt under debian/ubuntu</h4></div></div></div><p>安装环境 ubuntu 17.10</p><pre class="screen">
		
			sudo apt install mysql-server mysql-client
		
		</pre><p>New password for the MySQL "root" user</p><pre class="screen">
		
┌──────────────────────┤ Configuring mysql-server-5.7 ├─────────────────────┐
│ While not mandatory, it is highly recommended that you set a password for the MySQL administrative "root" user.  │
│                                                                                                                  │
│ If that field is left blank, the password will not be changed.                                                   │
│                                                                                                                  │
│ New password for the MySQL "root" user:                                                                          │
│                                                                                                                  │
│ ****____________________________________________________________________________________________________________ │
│                                                                                                                  │
│                                                      &lt;Ok&gt;                                                        │
│                                                                                                                  │
└─────────────────────────────────────────────────────────────┘
		
		</pre><p>Repeat password for the MySQL "root" user</p><pre class="screen">
		
         ┌───┤ Configuring mysql-server-5.7 ├────┐
         │                                             │
         │                                             │
         │ Repeat password for the MySQL "root" user:  │
         │                                             │
         │ ****_______________________________________ │
         │                                             │
         │                   &lt;Ok&gt;                      │
         │                                             │
         └─────────────────────────┘
         
		</pre><p>尝试登录，验证是否安装成功</p><pre class="screen">
		
# mysql -udbuser -p
Enter password:

mysql&gt; SHOW GRANTS;
+----------------------------------------------------------------------------------------------------------------------------------------+
| Grants for root@localhost                                                                                                              |
+----------------------------------------------------------------------------------------------------------------------------------------+
| GRANT ALL PRIVILEGES ON *.* TO 'root'@'localhost' IDENTIFIED BY PASSWORD '*C6325DAF39AE6CC34E960D3C65F1398FE467E1D0' WITH GRANT OPTION |
+----------------------------------------------------------------------------------------------------------------------------------------+
1 row in set (0.00 sec)

GRANT ALL PRIVILEGES ON example.* TO 'dbuser'@'localhost' IDENTIFIED BY '******' WITH GRANT OPTION;
FLUSH PRIVILEGES;
		
		</pre><p>配置监听IP地址，默认数据库只能从 127.0.0.1访问</p><pre class="screen">
			neo@netkiller /etc/mysql/mysql.conf.d % vim
			/etc/mysql/mysql.conf.d/mysqld.cnf

			bind-address = 0.0.0.0
		</pre><div class="section"><div class="titlepage"><div><div><h4 class="title"><a id="mysql-5.5.21"></a>19.1.4.1. mysql-5.5.21-debian6.0-i686.deb</h4></div></div></div><pre class="screen">
			
sudo apt-get install libaio1


sudo groupadd mysql
sudo useradd -r -g mysql mysql

sudo dpkg -i mysql-5.5.21-debian6.0-i686.deb

cd /opt/mysql/
sudo chown -R mysql .
sudo chgrp -R mysql .

cd server-5.5/

sudo support-files/binary-configure

sudo chown -R mysql data

# Next command is optional
shell&gt; cp support-files/my-medium.cnf /etc/my.cnf

shell&gt; bin/mysqld_safe --user=mysql &amp;

# Next command is optional
sudo cp support-files/mysql.server /etc/init.d/mysql
			
			</pre></div></div><div class="section"><div class="titlepage"><div><div><h3 class="title"><a id="mysql.source"></a>19.1.5. 源码安装</h3></div><div><h4 class="subtitle">Installation by source code</h4></div></div></div><pre class="screen">
		
./configure \
--prefix=/usr/local/$MYSQL_DIR \
--enable-assembler \
--enable-local-infile \
--with-charset=utf8 \
--with-collation=utf8_general_ci \
--with-extra-charsets=none \
--with-openssl \
--with-pthread \
--with-unix-socket-path=/var/lib/mysql/mysql.sock \
--with-mysqld-user=mysql \
--with-mysqld-ldflags \
--with-client-ldflags \
--with-comment \
--with-big-tables \
--without-ndb-debug \
--without-docs \
--without-debug \
--without-bench

make &amp;&amp; make install
		
		</pre><p>/usr/local/$MYSQL_DIR/bin/mysql_install_db</p><p>other option</p><pre class="screen">
			--without-isam
			--without-innodb
			--without-ndbcluster
			--without-blackhole
			--without-ibmdb2i
			--without-federated
			--without-example
			--without-comment
			--localstatedir=/usr/local/mysql/data
		</pre></div><div class="section"><div class="titlepage"><div><div><h3 class="title"><a id="mysql.binary"></a>19.1.6. 二进制版本</h3></div><div><h4 class="subtitle">MySQL binary distribution</h4></div></div></div><pre class="screen">
		
shell&gt; groupadd mysql
shell&gt; useradd -r -g mysql mysql
shell&gt; cd /usr/local
shell&gt; tar zxvf /path/to/mysql-VERSION-OS.tar.gz
shell&gt; ln -s full-path-to-mysql-VERSION-OS mysql
shell&gt; cd mysql
shell&gt; chown -R mysql .
shell&gt; chgrp -R mysql .
shell&gt; scripts/mysql_install_db --user=mysql
shell&gt; chown -R root .
shell&gt; chown -R mysql data
# Next command is optional
shell&gt; cp support-files/my-medium.cnf /etc/my.cnf
shell&gt; bin/mysqld_safe --user=mysql &amp;
# Next command is optional
shell&gt; cp support-files/mysql.server /etc/init.d/mysql.server
		
		</pre><p>install core database</p><pre class="screen">
		
[root@test mysql]# ./scripts/mysql_install_db
Installing MySQL system tables...
100428 23:16:20 [Warning] '--skip-locking' is deprecated and will be removed in a future release. Please use '--skip-external-locking' instead.
OK
Filling help tables...
100428 23:16:20 [Warning] '--skip-locking' is deprecated and will be removed in a future release. Please use '--skip-external-locking' instead.
OK

To start mysqld at boot time you have to copy
support-files/mysql.server to the right place for your system

PLEASE REMEMBER TO SET A PASSWORD FOR THE MySQL root USER !
To do so, start the server, then issue the following commands:

./bin/mysqladmin -u root password 'new-password'
./bin/mysqladmin -u root -h db.example.com password 'new-password'

Alternatively you can run:
./bin/mysql_secure_installation

which will also give you the option of removing the test
databases and anonymous user created by default.  This is
strongly recommended for production servers.

See the manual for more instructions.

You can start the MySQL daemon with:
cd . ; ./bin/mysqld_safe &amp;

You can test the MySQL daemon with mysql-test-run.pl
cd ./mysql-test ; perl mysql-test-run.pl

Please report any problems with the ./bin/mysqlbug script!
		
		</pre><p>set root's password</p><pre class="screen">
			[root@test mysql]# cp support-files/mysql.server
			/etc/init.d/mysqld
			[root@test mysql]# /etc/init.d/mysqld start
			Starting MySQL. [ OK ]

			[root@test mysql]# ./bin/mysqladmin -u root
			password 'chen'
			[root@test mysql]# ./bin/mysqladmin -u root -h
			db.example.com password 'chen'
		</pre><p>test</p><pre class="screen">
		
[root@test mysql]# ./bin/mysql -uroot -pchen
Welcome to the MySQL monitor.  Commands end with ; or \g.
Your MySQL connection id is 3
Server version: 5.1.45 MySQL Community Server (GPL)

Type 'help;' or '\h' for help. Type '\c' to clear the current input statement.

mysql&gt;
		
		</pre></div><div class="section"><div class="titlepage"><div><div><h3 class="title"><a id="mysql.yum"></a>19.1.7. Installing MySQL on Linux Using the MySQL Yum Repository</h3></div></div></div><div class="section"><div class="titlepage"><div><div><h4 class="title"><a id="idm219671973840"></a>19.1.7.1. MySQL 5.6</h4></div></div></div><p>http://dev.mysql.com/doc/mysql-repo-excerpt/5.6/en/linux-installation-yum-repo.html</p><pre class="screen">

yum localinstall http://dev.mysql.com/get/mysql-community-release-el6-5.noarch.rpm
			</pre><p>安装MySQL Server</p><pre class="screen">

yum install mysql-server
chkconfig mysqld on
service mysqld start		
			</pre><p>修改root密码</p><pre class="screen">

mysqladmin -u root password 'new-password'		
			</pre><p>安全设置向导</p><pre class="screen">

/usr/bin/mysql_secure_installation		
			</pre></div><div class="section"><div class="titlepage"><div><div><h4 class="title"><a id="idm219671970816"></a>19.1.7.2. MySQL 5.7</h4></div></div></div><pre class="screen">
			
yum localinstall -y https://dev.mysql.com/get/mysql57-community-release-el7-11.noarch.rpm
yum install mysql-server -y
systemctl enable mysqld
systemctl start mysqld

cp /etc/my.cnf{,.original}

cat &gt;&gt; /etc/security/limits.d/20-nofile.conf &lt;&lt;EOF

mysql soft nofile 40960
mysql hard nofile 40960
EOF

cat &gt;&gt; /etc/my.cnf.d/default.cnf &lt;&lt;EOF
[mysqld]
skip-name-resolve
max_connections=8192
default-storage-engine=INNODB

#wait_timeout=30
#interactive_timeout=30

character-set-server=utf8
collation_server=utf8_general_ci
init_connect='SET NAMES utf8'

explicit_defaults_for_timestamp=true

query_cache_type=1
query_cache_size=512M

[client]
character_set_client=utf8

EOF
			
			</pre><p>MySQL 5.7 会随机分配一个密码给用户</p><pre class="screen">

grep "A temporary password" /var/log/mysqld.log
			</pre><p>登陆后修改密码</p><pre class="screen">

ALTER USER root@localhost identified by 'MQiEge1ikst7S_6tlXzBOmt_4b';
ALTER USER root@localhost PASSWORD EXPIRE NEVER;
			</pre></div></div><div class="section"><div class="titlepage"><div><div><h3 class="title"><a id="firewall"></a>19.1.8. Firewall</h3></div></div></div><p>iptables</p><pre class="screen">
		
iptables -A INPUT -i eth0 -p tcp -s xxx.xxx.xxx.xxx --dport 3306 -j ACCEPT
		
		</pre></div><div class="section"><div class="titlepage"><div><div><h3 class="title"><a id="mac"></a>19.1.9. Mac OS</h3></div></div></div><pre class="screen">
		
brew install mysql
		
		</pre><p>启动</p><pre class="screen">
		
brew services start mysql
		
		</pre></div><div class="section"><div class="titlepage"><div><div><h3 class="title"><a id="mariadb"></a>19.1.10. MariaDB</h3></div></div></div><p>http://mariadb.org/</p><div class="section"><div class="titlepage"><div><div><h4 class="title"><a id="idm219671964576"></a>19.1.10.1. CentOS 6 YUM 安装 MariaDB</h4></div></div></div><pre class="screen">
		
cat &gt;&gt; /etc/yum.repos.d/MariaDB.repo &lt;&lt;EOF
# MariaDB 5.5 CentOS repository list - created 2013-12-04 02:17 UTC
# http://mariadb.org/mariadb/repositories/
[mariadb]
name = MariaDB
baseurl = http://yum.mariadb.org/5.5/centos6-amd64
gpgkey=https://yum.mariadb.org/RPM-GPG-KEY-MariaDB
gpgcheck=1
EOF
		
		</pre><pre class="screen">
# yum search MariaDB | grep MariaDB
============================= N/S Matched: MariaDB =============================
MariaDB-Galera-server.x86_64 : MariaDB: a very fast and robust SQL database
MariaDB-client.x86_64 : MariaDB: a very fast and robust SQL database server
MariaDB-common.x86_64 : MariaDB: a very fast and robust SQL database server
MariaDB-compat.x86_64 : MariaDB: a very fast and robust SQL database server
MariaDB-devel.x86_64 : MariaDB: a very fast and robust SQL database server
MariaDB-server.x86_64 : MariaDB: a very fast and robust SQL database server
MariaDB-shared.x86_64 : MariaDB: a very fast and robust SQL database server
MariaDB-test.x86_64 : MariaDB: a very fast and robust SQL database server
		</pre><p>安装数据库</p><pre class="screen">
# yum install -y MariaDB-server MariaDB-client
		</pre><p>指定默认root密码</p><pre class="screen">
# mysqladmin -u root password 'chen'
		</pre><p>数据库安全配置</p><pre class="screen">
# /usr/bin/mysql_secure_installation
/usr/bin/mysql_secure_installation: line 379: find_mysql_client: command not found

NOTE: RUNNING ALL PARTS OF THIS SCRIPT IS RECOMMENDED FOR ALL MariaDB
      SERVERS IN PRODUCTION USE!  PLEASE READ EACH STEP CAREFULLY!

In order to log into MariaDB to secure it, we'll need the current
password for the root user.  If you've just installed MariaDB, and
you haven't set the root password yet, the password will be blank,
so you should just press enter here.

Enter current password for root (enter for none):
OK, successfully used password, moving on...

Setting the root password ensures that nobody can log into the MariaDB
root user without the proper authorisation.

You already have a root password set, so you can safely answer 'n'.

Change the root password? [Y/n]
New password:
Re-enter new password:
Password updated successfully!
Reloading privilege tables..
 ... Success!


By default, a MariaDB installation has an anonymous user, allowing anyone
to log into MariaDB without having to have a user account created for
them.  This is intended only for testing, and to make the installation
go a bit smoother.  You should remove them before moving into a
production environment.

Remove anonymous users? [Y/n]
 ... Success!

Normally, root should only be allowed to connect from 'localhost'.  This
ensures that someone cannot guess at the root password from the network.

Disallow root login remotely? [Y/n]
 ... Success!

By default, MariaDB comes with a database named 'test' that anyone can
access.  This is also intended only for testing, and should be removed
before moving into a production environment.

Remove test database and access to it? [Y/n]
 - Dropping test database...
 ... Success!
 - Removing privileges on test database...
 ... Success!

Reloading the privilege tables will ensure that all changes made so far
will take effect immediately.

Reload privilege tables now? [Y/n]
 ... Success!

Cleaning up...

All done!  If you've completed all of the above steps, your MariaDB
installation should now be secure.

Thanks for using MariaDB!
		</pre><p>进入数据库</p><pre class="screen">
		
# mysql -uroot -pchen
Welcome to the MariaDB monitor.  Commands end with ; or \g.
Your MariaDB connection id is 12
Server version: 5.5.34-MariaDB MariaDB Server

Copyright (c) 2000, 2013, Oracle, Monty Program Ab and others.

Type 'help;' or '\h' for help. Type '\c' to clear the current input statement.

MariaDB [(none)]&gt; show databases;
+--------------------+
| Database           |
+--------------------+
| information_schema |
| mysql              |
| performance_schema |
+--------------------+
3 rows in set (0.00 sec)

MariaDB [(none)]&gt; use mysql;
Reading table information for completion of table and column names
You can turn off this feature to get a quicker startup with -A

Database changed
MariaDB [mysql]&gt;
		
		</pre><p>使用上与MySQL并无差异</p></div><div class="section"><div class="titlepage"><div><div><h4 class="title"><a id="idm219671964448"></a>19.1.10.2. CentOS 7 安装 MariaDB</h4></div></div></div><p></p><pre class="screen">
		
yum install -y mariadb		
		
		</pre></div></div><div class="section"><div class="titlepage"><div><div><h3 class="title"><a id="percona"></a>19.1.11. Percona</h3></div></div></div><p>http://www.percona.com/</p><div class="section"><div class="titlepage"><div><div><h4 class="title"><a id="idm219671956288"></a>19.1.11.1. Percona yum Repository</h4></div></div></div><pre class="screen">
# yum install http://www.percona.com/redir/downloads/percona-release/redhat/latest/percona-release-0.1-3.noarch.rpm
		</pre><p>查看所有percona软件包</p><pre class="screen">
yum search percona
		</pre></div><div class="section"><div class="titlepage"><div><div><h4 class="title"><a id="xtrabackup"></a>19.1.11.2. Percona XtraBackup</h4></div></div></div><div class="section"><div class="titlepage"><div><div><h5 class="title"><a id="idm219671954320"></a>安装 XtraBackup</h5></div></div></div><p>通过YUM安装 percona-xtrabackup</p><pre class="screen">
# yum install percona-xtrabackup
			</pre><p>通过RPM安装 CentOS 6</p><p>http://www.percona.com/downloads/XtraBackup/LATEST/binary/redhat/6/x86_64/</p><pre class="screen">
# yum install -y http://www.percona.com/redir/downloads/XtraBackup/LATEST/binary/redhat/6/x86_64/percona-xtrabackup-2.2.6-5042.el6.x86_64.rpm
			</pre><p>通过RPM安装 CentOS 7</p><p>http://www.percona.com/downloads/XtraBackup/LATEST/binary/redhat/7/x86_64/</p><pre class="screen">
# yum install -y http://www.percona.com/redir/downloads/XtraBackup/LATEST/binary/redhat/7/x86_64/percona-xtrabackup-2.2.6-5042.el7.x86_64.rpm
			</pre><p>卸载</p><pre class="screen">
# yum remove percona-xtrabackup
			</pre><p>查看文件列表</p><pre class="screen">
# rpm -ql percona-xtrabackup
/usr/bin/innobackupex
/usr/bin/xbcrypt
/usr/bin/xbstream
/usr/bin/xtrabackup
/usr/share/doc/percona-xtrabackup-2.2.6
/usr/share/doc/percona-xtrabackup-2.2.6/COPYING
			</pre></div><div class="section"><div class="titlepage"><div><div><h5 class="title"><a id="idm219671954192"></a>innobackupex</h5></div></div></div><p>首先创建备份用户</p><pre class="screen">
			
mysql&gt; CREATE USER 'backup'@'localhost' IDENTIFIED BY 's3cret';
mysql&gt; GRANT RELOAD, LOCK TABLES, REPLICATION CLIENT ON *.* TO 'backup'@'localhost';
mysql&gt; FLUSH PRIVILEGES;
			
			</pre><div class="section"><div class="titlepage"><div><div><h6 class="title"><a id="idm219671948640"></a>备份数据库</h6></div></div></div><p>备份所有数据库</p><pre class="screen">
# mkdir -p /backup
# innobackupex --user=backup --password=chen /backup/full
				</pre><p>备份指定数据库</p><pre class="screen">
# innobackupex --user=backup --password=chen --database=test /backup
				</pre><p>--defaults-file=/etc/my.cnf 参数</p><pre class="screen">
# innobackupex --defaults-file=/etc/my.cnf --user=backup --password=chen --database=test /backup
				</pre><p>备份后打包</p><pre class="screen">
# innobackupex --user=backup --password=chen --database=test --stream=tar /backup/  &gt; test.tar
				</pre><p>打包并压缩</p><pre class="screen">
# innobackupex --user=backup --password=chen --database=test --stream=tar /backup/ | gzip &gt; test.tar.gz
				</pre><p>备份到远程服务器</p><pre class="screen">
# innobackupex --user=backup --password=chen --defaults-file=/etc/my.cnf --database=test --stream=tar /backup | gzip | ssh neo@192.168.2.1 cat "&gt;"   /backup/backup-2014-11-12.tar.gz
				</pre><p>增量备份</p><pre class="screen">
# innobackupex --user=backup --password=chen --database=test /backup/incremental
# ls /backup/incremental
2014-11-12_13-45-26
# innobackupex --user=backup --password=chen --database=test --incremental --incremental-basedir=/backup/incremental/2014-11-12_13-45-26/ /backup/incremental
				</pre></div><div class="section"><div class="titlepage"><div><div><h6 class="title"><a id="idm219671948512"></a>恢复数据库</h6></div></div></div><p>恢复数据首先停止MySQL服务</p><pre class="screen">
# service mysql stop
				</pre><p>恢复文件</p><pre class="screen">
# innobackupex --copy-back /path/to/BACKUP-DIR
# innobackupex --user=backup --password=chen --apply-log /backup/full/2014-11-12_13-45-26/
				</pre><p>数据恢复完成后修改权限</p><pre class="screen">
$ chown -R mysql:mysql /var/lib/mysql
				</pre><p>增量备份恢复方法</p><pre class="screen">
innobackupex --apply-log --redo-only BASE-DIR
innobackupex --apply-log --redo-only BASE-DIR --incremental-dir=INCREMENTAL-DIR-1
innobackupex --apply-log BASE-DIR --incremental-dir=INCREMENTAL-DIR-2
innobackupex --apply-log BASE-DIR
innobackupex --copy-back BASE-DIR
				</pre></div></div><div class="section"><div class="titlepage"><div><div><h5 class="title"><a id="idm219671940160"></a>xbstream</h5></div></div></div><pre class="screen">
			
$ innobackupex --stream=tar /tmp
$ innobackupex --stream=xbstream /root/backup/ &gt; /root/backup/backup.xbstream
$ innobackupex --stream=xbstream --compress /root/backup/ &gt; /root/backup/backup.xbstream

$ xbstream -x &lt;  backup.xbstream -C /root/backup/
$ innobackupex --compress --stream=xbstream /root/backup/ | ssh user@otherhost "xbstream -x -C /root/backup/"
			
			</pre></div><div class="section"><div class="titlepage"><div><div><h5 class="title"><a id="idm219671939136"></a>xtrabackup</h5></div></div></div><pre class="screen">
# xtrabackup --user=backup --password=chen --backup --target-dir=/backup/backup
			</pre></div></div><div class="section"><div class="titlepage"><div><div><h4 class="title"><a id="toolkit"></a>19.1.11.3. Percona Toolkit - MySQL Management Software</h4></div></div></div><p>YUM安装</p><pre class="screen">
# yum install -y percona-toolkit
		</pre><p>RPM安装</p><pre class="screen">
# yum install -y http://www.percona.com/redir/downloads/percona-toolkit/LATEST/RPM/percona-toolkit-2.2.11-1.noarch.rpm
		</pre><p>percona-toolkit 所含的文件</p><pre class="screen">
# rpm -ql percona-toolkit
/usr/bin/pt-align
/usr/bin/pt-archiver
/usr/bin/pt-config-diff
/usr/bin/pt-deadlock-logger
/usr/bin/pt-diskstats
/usr/bin/pt-duplicate-key-checker
/usr/bin/pt-fifo-split
/usr/bin/pt-find
/usr/bin/pt-fingerprint
/usr/bin/pt-fk-error-logger
/usr/bin/pt-heartbeat
/usr/bin/pt-index-usage
/usr/bin/pt-ioprofile
/usr/bin/pt-kill
/usr/bin/pt-mext
/usr/bin/pt-mysql-summary
/usr/bin/pt-online-schema-change
/usr/bin/pt-pmp
/usr/bin/pt-query-digest
/usr/bin/pt-show-grants
/usr/bin/pt-sift
/usr/bin/pt-slave-delay
/usr/bin/pt-slave-find
/usr/bin/pt-slave-restart
/usr/bin/pt-stalk
/usr/bin/pt-summary
/usr/bin/pt-table-checksum
/usr/bin/pt-table-sync
/usr/bin/pt-table-usage
/usr/bin/pt-upgrade
/usr/bin/pt-variable-advisor
/usr/bin/pt-visual-explain
/usr/share/doc/percona-toolkit-2.2.11
/usr/share/doc/percona-toolkit-2.2.11/COPYING
/usr/share/doc/percona-toolkit-2.2.11/Changelog
/usr/share/doc/percona-toolkit-2.2.11/INSTALL
/usr/share/doc/percona-toolkit-2.2.11/README
/usr/share/man/man1/percona-toolkit.1p.gz
/usr/share/man/man1/pt-align.1p.gz
/usr/share/man/man1/pt-archiver.1p.gz
/usr/share/man/man1/pt-config-diff.1p.gz
/usr/share/man/man1/pt-deadlock-logger.1p.gz
/usr/share/man/man1/pt-diskstats.1p.gz
/usr/share/man/man1/pt-duplicate-key-checker.1p.gz
/usr/share/man/man1/pt-fifo-split.1p.gz
/usr/share/man/man1/pt-find.1p.gz
/usr/share/man/man1/pt-fingerprint.1p.gz
/usr/share/man/man1/pt-fk-error-logger.1p.gz
/usr/share/man/man1/pt-heartbeat.1p.gz
/usr/share/man/man1/pt-index-usage.1p.gz
/usr/share/man/man1/pt-ioprofile.1p.gz
/usr/share/man/man1/pt-kill.1p.gz
/usr/share/man/man1/pt-mext.1p.gz
/usr/share/man/man1/pt-mysql-summary.1p.gz
/usr/share/man/man1/pt-online-schema-change.1p.gz
/usr/share/man/man1/pt-pmp.1p.gz
/usr/share/man/man1/pt-query-digest.1p.gz
/usr/share/man/man1/pt-show-grants.1p.gz
/usr/share/man/man1/pt-sift.1p.gz
/usr/share/man/man1/pt-slave-delay.1p.gz
/usr/share/man/man1/pt-slave-find.1p.gz
/usr/share/man/man1/pt-slave-restart.1p.gz
/usr/share/man/man1/pt-stalk.1p.gz
/usr/share/man/man1/pt-summary.1p.gz
/usr/share/man/man1/pt-table-checksum.1p.gz
/usr/share/man/man1/pt-table-sync.1p.gz
/usr/share/man/man1/pt-table-usage.1p.gz
/usr/share/man/man1/pt-upgrade.1p.gz
/usr/share/man/man1/pt-variable-advisor.1p.gz
/usr/share/man/man1/pt-visual-explain.1p.gz		
		</pre></div></div></div></div><div xmlns="" id="SOHUCS"></div><script xmlns="" charset="utf-8" type="text/javascript" src="https://cy-cdn.kuaizhan.com/upload/changyan.js"></script><script xmlns="" type="text/javascript">
window.changyan.api.config({
appid: 'cyvwjQUG3',
conf: 'prod_ef966242df3d8b5acb1e0ee9fc01cafe'
});
</script><script xmlns="" type="text/javascript" id="clustrmaps" src="//cdn.clustrmaps.com/map_v2.js?u=r5HG&amp;d=9mi5r_kkDC8uxG8HuY3p4-2qgeeVypAK9vMD-2P6BYM"></script><div class="navfooter"><hr /><table width="100%" summary="Navigation footer"><tr><td width="40%" align="left"><a accesskey="p" href="../index.html">上一页</a> </td><td width="20%" align="center"><a accesskey="u" href="../index.html">上一级</a></td><td width="40%" align="right"> <a accesskey="n" href="plugin.html">下一页</a></td></tr><tr><td width="40%" align="left" valign="top">部分 III. MySQL </td><td width="20%" align="center"><a accesskey="h" href="../../index.html">起始页</a></td><td width="40%" align="right" valign="top"> 19.2. MySQL Plugin</td></tr></table></div><script xmlns="">
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

  ga('create', 'UA-11694057-1', 'auto');
  ga('send', 'pageview');

</script><script xmlns="" async="async">
var _hmt = _hmt || [];
(function() {
  var hm = document.createElement("script");
  hm.src = "https://hm.baidu.com/hm.js?93967759a51cda79e49bf4e34d0b0f2c";
  var s = document.getElementsByTagName("script")[0]; 
  s.parentNode.insertBefore(hm, s);
})();
</script><script xmlns="" async="async">
(function(){
    var bp = document.createElement('script');
    var curProtocol = window.location.protocol.split(':')[0];
    if (curProtocol === 'https') {
        bp.src = 'https://zz.bdstatic.com/linksubmit/push.js';        
    }
    else {
        bp.src = 'http://push.zhanzhang.baidu.com/push.js';
    }
    var s = document.getElementsByTagName("script")[0];
    s.parentNode.insertBefore(bp, s);
})();
</script></body></html>